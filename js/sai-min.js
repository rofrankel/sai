Sai={};Sai.util={};Sai.imagePath=typeof Sai.imagePath!=="undefined"&&Sai.imagePath!==null?Sai.imagePath:"/static/images/sai/";Sai.util.roundToMag=function(o,p){var i;p=typeof p!=="undefined"&&p!==null?p:0;i=Math.pow(10,p);return parseFloat((Math.round(o/i)*i).toFixed(Math.max(0,p)))};Sai.util.round=function(o,p){return parseFloat((Math.round(o/p)*p).toFixed(Math.max(0,Math.ceil(-1*Math.log(p)/Math.LN10))))};
Sai.util.sumArray=function(o){var p,i,a;a=0;p=o.length;for(i=0;0<=p?i<p:i>p;0<=p?i+=1:i-=1)a+=typeof o[i]==="number"?o[i]:0;return a};Sai.util.prettystr=function(o,p){var i;p=typeof p!=="undefined"&&p!==null?p:2;if(typeof o==="number"){if(Math.abs(o)>=1E12){i="t";o/=1E12}else if(Math.abs(o)>=1E9){i="b";o/=1E9}else if(Math.abs(o)>=1E6){i="m";o/=1E6}else if(Math.abs(o)>=1E3){i="k";o/=1E3}else return String(parseFloat(o.toFixed(p)));return parseFloat(o.toFixed(1))+i}return o};
Sai.util.prettynum=function(o){var p;if(!(isNaN(parseFloat(o))||!String(o).match(/^[-+]?\d+(\.\d+)?$/))){o=String(o).split(".");for(p=/(\d+)(\d{3})/;p.test(o[0]);)o[0]=o[0].replace(p,"$1,$2");return o[0]+(o.length>1?parseFloat("0."+o[1]).toFixed(2).slice(1):"")}};Sai.util.infoSetters=function(o,p){return[function(){return o(p)},function(){return o()}]};
Sai.util.transformCoords=function(o,p){var i;if(p.getScreenCTM){i=p.createSVGPoint();i.x=o.clientX;i.y=o.clientY;i=i.matrixTransform(p.getScreenCTM().inverse());if(navigator.userAgent.toLowerCase().indexOf("chrome")!==-1||navigator.userAgent.toLowerCase().indexOf("safari")!==-1){i.x+=document.body.scrollLeft;i.y+=document.body.scrollTop}return{x:i.x,y:i.y}}else return{x:o.x,y:o.y}};
Sai.util.multiplyColor=function(o,p,i,a){a=typeof a!=="undefined"&&a!==null?a:0;p=a+(1-a)*p;a=Raphael.getRGB(o);if(i){o=a.r+(255-a.r)*(1-p);i=a.g+(255-a.g)*(1-p);p=a.b+(255-a.b)*(1-p)}else{o=a.r*p;i=a.g*p;p=a.b*p}return{r:o,g:i,b:p,str:"rgb("+o+", "+i+", "+p+")"}};Sai.util.colerp=function(o,p,i){o=Raphael.getRGB(o);p=Raphael.getRGB(p);return"rgb("+(p.r*i+o.r*(1-i))+", "+(p.g*i+o.g*(1-i))+", "+(p.b*i+o.b*(1-i))+")"};
Sai.util.reflectColor=function(o,p){var i,a,c,b,d,f,e,h,g;f=Raphael.getRGB(o);h=Raphael.getRGB(p);g={};c=["r","g","b"];i=0;for(a=c.length;i<a;i++){d=c[i];b=f[d];e=h[d];g[d]=b===e?b:b>e?e*((255-b)/(255-e)):(255*(e-b)+e*b)/e}return"rgb("+g.r+", "+g.g+", "+g.b+")"};Sai.data=typeof Sai.data!=="undefined"&&Sai.data!==null?Sai.data:{};Sai.data.map=typeof Sai.data.map!=="undefined"&&Sai.data.map!==null?Sai.data.map:{};
Raphael.fn.sai=typeof Raphael.fn.sai!=="undefined"&&Raphael.fn.sai!==null?Raphael.fn.sai:{};Raphael.fn.sai.chart=function(o,p,i,a,c,b){c=typeof{line:Sai.LineChart}[c]!=="undefined"&&{line:Sai.LineChart}[c]!==null?{line:Sai.LineChart}[c]:c;c=typeof c!=="undefined"&&c!==null?c:Sai.Chart;return(new c(this,o,p,i,a,b)).render()};(function(){var o,p=Object.prototype.hasOwnProperty;Raphael.fn.sai.prim=typeof Raphael.fn.sai.prim!=="undefined"&&Raphael.fn.sai.prim!==null?Raphael.fn.sai.prim:{};o=function(i,a,c,b){return[function(){var d;i.attr(a);return typeof(d=typeof b==="undefined"||b===null?undefined:b[0])==="function"?d(i):undefined},function(){var d;i.attr(c);return typeof(d=typeof b==="undefined"||b===null?undefined:b[1])==="function"?d(i):undefined}]};Raphael.fn.sai.prim.candlestick=function(i,a,c,b,d,f,e,h,g,j,m){e=
typeof e!=="undefined"&&e!==null?e:"#000000";f%2||f++;f=this.rect(i-f/2,a,f,c-a||1).attr("stroke",e);b=this.path("M"+i+" "+b+"L"+i+" "+a+"M"+i+" "+c+"L"+i+" "+d).attr("stroke",e);f.attr("fill",h?e:"#ffffff");e=this.set().push(f,b);if(g){i=o(e,{scale:"1.5,1.5,"+i+","+(a+(c-a)/2),"fill-opacity":0.5},{scale:"1.0,1.0,"+i+","+(a+(c-a)/2),"fill-opacity":1},m);e.hover(i[0],i[1])}return e};Raphael.fn.sai.prim.line=function(i,a,c){var b,d,f,e;a=typeof a!=="undefined"&&a!==null?a:"#000000";c=typeof c!=="undefined"&&
c!==null?c:1;b=0;for(d=i.length;b<d;b++){f=i[b];if(typeof f!=="undefined"&&f!==null)if(typeof e!=="undefined"&&e!==null)e+="L"+f[0]+" "+f[1];else e="M"+f[0]+" "+f[1]}return this.path(e).attr({stroke:a,"stroke-width":c})};Raphael.fn.sai.prim.area=function(i,a,c,b){var d,f,e,h,g;if(i.length<2)return this.set();a=typeof a!=="undefined"&&a!==null?a:"#000000";c=typeof c!=="undefined"&&c!==null?c:1;d=0;for(f=i.length;d<f;d++){h=i[d];if(typeof h!=="undefined"&&h!==null)if(typeof g!=="undefined"&&g!==null){g+=
"L"+h[0]+" "+h[1];e+="L"+h[0]+" "+h[1]}else{g="M"+h[0]+" "+h[1];e="M"+h[0]+" "+h[1]}}for(i=b.length-1;b.length-1<=0?i<=0:i>=0;i+=-1)e+="L"+b[i][0]+","+b[i][1];b=this.path(e).attr({fill:a,"stroke-width":0,"stroke-opacity":0,"fill-opacity":0.35});a=this.path(g).attr({stroke:a,"stroke-width":c});return this.set().push(b,a)};Raphael.fn.sai.prim.stackedBar=function(i,a,c,b,d,f,e){var h,g,j,m,k,n,q,l,t,r,s,u;if(d){l=t=null;j=i;h=0;for(g=j.length;h<g;h++){n=j[h];if(!(typeof l!=="undefined"&&l!==null)||l<
n[1])l=n[1];if(!(typeof t!=="undefined"&&t!==null)||t>n[1])t=n[1]}u=l-t||1}c*=0.67;s=this.set();t=[b,b];l=function(v){return v<b?1:0};j=i.length;for(h=0;0<=j?h<j:h>j;0<=j?h+=1:h-=1){g=h;if(typeof(m=i[g])!=="undefined"&&m!==null&&i[g][1]!==b){n=l(i[g][1]);q=Math.abs(t[n]-i[g][1]);k=t[n]===b?1:0;r=i[g][1]-(n?0:q-k);s.push(k=this.rect(i[g][0]-c/2,r,c,q-k).attr("fill",(typeof a==="undefined"||a===null?undefined:a[g])||"#000000").attr("stroke",(typeof a==="undefined"||a===null?undefined:a[g])||"#000000"));
if(d){q=o(k,{"fill-opacity":"0.75"},{"fill-opacity":"1.0"},[function(v){return function(){e[0]&&e[0]();return f({"(selected)":Sai.util.prettystr(v)+"%"},false)}}(100*q/u),e[1]]);k.hover(q[0],q[1])}t[n]=i[g][1]}}return s};Raphael.fn.sai.prim.groupedBar=function(i,a,c,b,d,f,e){var h,g,j,m,k,n;f=this.set();g=c/(i.length+1);n=(c-g)/2;c=i.length;for(k=0;0<=c?k<c:k>c;0<=c?k+=1:k-=1)if(typeof(h=i[k]==null?undefined:i[k][0])!=="undefined"&&h!==null){j=Math.min(i[k][1],b);m=Math.max(i[k][1],b)-j-0.5;f.push(this.rect(i[k][0]-
n+k*g,j,g-1,m).attr("fill",(typeof a==="undefined"||a===null?undefined:a[k])||"#000000").attr("stroke",(typeof a==="undefined"||a===null?undefined:a[k])||"#000000"))}if(d){i=o(f,{"fill-opacity":"0.75"},{"fill-opacity":"1.0"},e);f.hover(i[0],i[1])}return f};Raphael.fn.sai.prim.haxis=function(i,a,c,b,d){var f,e,h,g,j,m,k,n,q,l,t,r,s,u,v,z,y,B,w;s=typeof(e=d.ticklens)!=="undefined"&&e!==null?e:[5,2];z=typeof(e=d.width)!=="undefined"&&e!==null?e:1;j=typeof(e=d.color)!=="undefined"&&e!==null?e:"black";
q=this.path("M"+a+" "+c+"l"+b+" 0").attr("stroke",j);u=this.set();f=this.set();e=b/25;n=e<i.length?Math.ceil(i.length/e):1;m=b/(i.length-1)*n;B=a;y=-1;r=false;t=0;w=null;e=i.length;for(k=0;0<=e?k<e:k>e;k+=n){h=i[k];if(typeof h!=="undefined"&&h!==null){g=s[String(h)?0:1];u.push(this.path("M"+B+" "+c+"l0 "+g).attr("stroke",j));if(h!==""){g=this.text(B,c+g+2,Sai.util.prettystr(h).substring(0,12));h=g.getBBox();l=g.attr("y")+5;g.attr("y",l);if(!(typeof w!=="undefined"&&w!==null)||l<w)w=l;f.push(g);g=
h.width;t=Math.max(g,t);if(h.x<=y+3)r=true;if(h.x+g>y)y=h.x+g}}B+=m}if(typeof(e=d.title)!=="undefined"&&e!==null)v=this.text(a+b/2,w+14,d.title).attr({"font-size":"12px","font-weight":"bold"});i=this.set().push(q,u,f,v);if(r){e=f.items;f=0;for(b=e.length;f<b;f++){g=e[f];g.rotate(-90);g.translate(0,g.getBBox().width/2-2)}i.push(this.rect(a,c,1,z+t+s[0]).attr("opacity","0"))}return i};Raphael.fn.sai.prim.vaxis=function(i,a,c,b,d){var f,e,h,g,j,m,k,n,q,l,t,r,s,u,v;t=typeof(e=d.ticklens)!=="undefined"&&
e!==null?e:[5,2];e=d.width;h=typeof(e=d.color)!=="undefined"&&e!==null?e:"black";l=typeof(e=d.right)!=="undefined"&&e!==null?e:false;n=this.path("M"+a+" "+c+"l0 "+-b).attr("stroke",h);r=this.set();k=this.set();j=b/(i.length-1);v=c;u=null;e=i;i=0;for(f=e.length;i<f;i++){m=e[i];if(m!==null){q=t[String(m)?0:1];r.push(this.path("M"+a+" "+v+"l"+(l?q:-q)+" 0").attr("stroke",h));q=a+(l?1:-1)*(q+3);m=this.text(q,v,Sai.util.prettystr(m));m.attr({"text-anchor":l?"start":"end",fill:h});q+=(l?1:-1)*(m.getBBox().width+
8);if(!(typeof u!=="undefined"&&u!==null)||q<u)u=q;k.push(m)}v-=j}if(typeof(e=d.title)!=="undefined"&&e!==null){s=this.text(u,c-b/2,d.title).attr({"font-size":"12px","font-weight":"bold"});a=s.getBBox();s.rotate(-90);g=this.rect(a.x+(a.width-a.height)/2,c,a.height,1).attr({opacity:0})}g=typeof g!=="undefined"&&g!==null?g:null;return this.set().push(this.set().push(n,r,k,g),s)};Raphael.fn.sai.prim.popup=function(i,a,c){var b,d,f,e,h,g;this.set();g=this.set();d=0;f=a+5+5;if("__HEAD__"in c){b=this.text(i,
f,c.__HEAD__).attr({fill:"#cfc","font-size":"12","font-weight":"bold"});d=Math.max(d,b.getBBox().width);g.push(b);f+=17}for(h in c)if(p.call(c,h))if(h!=="__HEAD__"){e=this.text(i+5,f,h+" = "+c[h]).attr({fill:"white","font-weight":"bold","text-anchor":"start"});d=Math.max(d,e.getBBox().width);f+=10;g.push(e)}c=d+10;this.rect(i,a,c,f-a,5).attr({fill:"black","fill-opacity":".85",stroke:"black"});typeof b==="undefined"||b===null||b.translate(c/2);return g.toFront()};Raphael.fn.sai.prim.legend=function(i,
a,c,b,d){var f,e,h,g,j,m,k;a-=14;m=this.set();g=i;j=a;for(k in b)if(p.call(b,k)){h=this.text(g+14,j+5,k).attr({fill:typeof(f=typeof d==="undefined"||d===null?undefined:d[k])!=="undefined"&&f!==null?f:"black","text-anchor":"start"});e=this.rect(g,j,9,9).attr({fill:typeof(f=b[k])!=="undefined"&&f!==null?f:"black",stroke:typeof(f=typeof d==="undefined"||d===null?undefined:d[k])!=="undefined"&&f!==null?f:"black"});e=this.set().push(h,e);h=e.getBBox().width;if(g-i+15+h>c){m.translate(0,-14);e.translate(i-
g,a-j);g=i;j=a}g+=h+15;m.push(e)}return m};Raphael.fn.sai.prim.wrappedText=function(i,a,c,b,d){var f,e,h,g;d=typeof d!=="undefined"&&d!==null?d:" ";b=typeof b!=="undefined"&&b!==null?b:"";if(b.match(/^\s*$/))return null;c=c/6;h=[];for(e=0;e<b.length-1;){f=e+c;g=b.substring(e,f+1);f=f>=b.length?f:g.lastIndexOf(d);h.push(g.substring(0,f));e+=f+1}b=h.join("\n");return this.text(i,a+5*h.length,b).attr({"font-family":"Lucida Console","text-anchor":"start"})};Raphael.fn.sai.prim.info=function(i,a,c,b){var d,
f,e,h,g,j;h=this.set();e=i;a=a;for(f in b)if(p.call(b,f))if(b[f]!==null){g=f+(f===""?"":": ");g+=typeof b[f]==="string"?b[f]:typeof(d=Sai.util.prettynum(b[f]))!=="undefined"&&d!==null?d:Sai.util.prettystr(b[f]);j=6*g.length;if(e-i+j>c){e=i;a+=14}g=this.text(e,a,g).attr({"font-family":"Lucida Console","text-anchor":"start"});e+=j+15;h.push(g)}return h};Raphael.fn.sai.prim.hoverShape=function(i,a,c,b){i=i(this).attr(a);c=o(i,b&&b[0]||{},b&&b[1]||{},c);i.mouseover(c[0]);i.mouseout(c[1]);return i};Raphael.fn.sai.prim.histogram=
function(i,a,c,b,d,f,e,h,g,j,m,k){var n,q,l,t,r;j=typeof j!=="undefined"&&j!==null?j:"white";g=typeof g!=="undefined"&&g!==null?g:["black","white"];k=typeof k!=="undefined"&&k!==null?k:10;r=this.set();r.push(this.rect(i,a-b,c,b).attr({"stroke-width":0,"stroke-opacity":0,fill:j}));b=a-(b-12);a-=5;f=typeof f!=="undefined"&&f!==null?f:0;e=typeof e!=="undefined"&&e!==null?e:1;r.push(this.text(i,a,Sai.util.prettystr(f)).attr({"text-anchor":"start"}));r.push(this.text(i+c,a,Sai.util.prettystr(e)).attr({"text-anchor":"end"}));
a-=7;f={};e=0;d=d;j=0;for(n=d.length;j<n;j++){l=d[j];l=Math.min(k-1,Math.floor(k*l/1));if(l in f)f[l]+=1;else f[l]=1;e=Math.max(e,f[l])}r.push(this.rect(i,a,c,1).attr({fill:"0-"+g[0]+"-"+(typeof(d=g[1])!=="undefined"&&d!==null?d:g[0]),"stroke-width":0,"stroke-opacity":0}));a-=1;n=c/k;d=f;for(q in d)if(p.call(d,q)){j=(a-b)*(f[q]/e);r.push(g.length===1?t=Sai.util.multiplyColor(g[0],(parseInt(q)+0.5)/k,m,0.2).str:t=Sai.util.colerp(g[0],g[1],(parseInt(q)+0.5)/k),this.rect(i+(parseInt(q)+0.2)*n,a-j,n*
0.6,j).attr({fill:t,"stroke-width":m?0.35:0,"stroke-opacity":m?1:0,stroke:"#000000"}))}r.push(this.text(i+c/2,b-6,Sai.util.prettystr(h)));return r}}).call(this);(function(){var o=Object.prototype.hasOwnProperty,p=function(a,c){var b=function(){};b.prototype=c.prototype;a.prototype=new b;a.prototype.constructor=a;typeof c.extended==="function"&&c.extended(a);a.__super__=c.prototype},i=function(a,c){return function(){return a.apply(c,arguments)}};Sai.Plot=function(a,c,b,d,f,e,h,g){this.opts=g;this.rawdata=h;this.data=e;this.h=f;this.w=d;this.y=b;this.x=c;this.r=a;this.opts=typeof this.opts!=="undefined"&&this.opts!==null?this.opts:{};this.setDenormalizedData();
this.set=this.r.set();return this};Sai.Plot.prototype.setDenormalizedData=function(){var a,c,b,d,f,e,h,g,j;if(this.data instanceof Array){e=[];d=this.data;a=0;for(b=d.length;a<b;a++){g=d[a];e.push(this.denormalize(g))}return this.dndata=e}else{this.dndata=typeof this.dndata!=="undefined"&&this.dndata!==null?this.dndata:{};e=[];d=this.data;for(j in d)if(o.call(d,j)){a=d[j];e.push(this.dndata[j]=function(){h=[];f=this.data[j];c=0;for(b=f.length;c<b;c++){g=f[c];h.push(this.denormalize(g))}return h}.call(this))}return e}};
Sai.Plot.prototype.denormalize=function(a){if(a instanceof Array)return[this.x+this.w*a[0],this.y-this.h*a[1]]};Sai.Plot.prototype.render=function(){this.set.push(this.r.rect(20,20,20,20).attr("fill","red"),this.r.circle(40,40,10).attr("fill","blue"));return this};Sai.LinePlot=function(){return Sai.Plot.apply(this,arguments)};p(Sai.LinePlot,Sai.Plot);Sai.LinePlot.prototype.setDenormalizedData=function(){var a,c,b;Sai.LinePlot.__super__.setDenormalizedData.apply(this,arguments);c=[];a=this.dndata;
for(b in a)if(o.call(a,b))c.push(this.dndata[b].length===1&&(this.dndata[b]==null?undefined:this.dndata[b][0]==null?undefined:this.dndata[b][0][0])===this.x?this.dndata[b].push([this.x+this.w,this.dndata[b][0][1]]):null);return c};Sai.LinePlot.prototype.render=function(a,c){var b,d;this.set.remove();b=this.dndata;for(d in b)if(o.call(b,d))d.match("^__")||this.set.push(this.r.sai.prim.line(this.dndata[d],(typeof a==="undefined"||a===null?undefined:a[d])||"black",c||1));return this};Sai.AreaPlot=function(){return Sai.LinePlot.apply(this,
arguments)};p(Sai.AreaPlot,Sai.LinePlot);Sai.AreaPlot.prototype.render=function(a,c,b,d){var f,e,h,g,j,m,k,n,q;this.set.remove();m=[this.denormalize([0,d]),this.denormalize([1,d])];d=this.dndata;for(q in d)if(o.call(d,q))if(!q.match("^__")){h=this.dndata[q].length;for(e=0;0<=h?e<h:e>h;0<=h?e+=1:e-=1){k=this.dndata[q][e];if(typeof k!=="undefined"&&k!==null)break}for(e=this.dndata[q].length-1;this.dndata[q].length-1<=0?e<=0:e>=0;this.dndata[q].length-1<=0?e+=1:e-=1){n=this.dndata[q][e];if(typeof n!==
"undefined"&&n!==null)break}typeof f!=="undefined"&&f!==null&&b||(f=[[k[0],m[0][1]],[n[0],m[1][1]]]);this.set.push(this.r.sai.prim.area(this.dndata[q],(typeof a==="undefined"||a===null?undefined:a[q])||"black",c||1,f));if(b){g=[];h=this.dndata[q];f=0;for(e=h.length;f<e;f++){j=h[f];g.push([j[0],j[1]-c/2])}f=g}}return this};Sai.CandlestickPlot=function(){return Sai.Plot.apply(this,arguments)};p(Sai.CandlestickPlot,Sai.Plot);Sai.CandlestickPlot.prototype.render=function(a,c,b,d){var f,e,h,g,j,m,k;this.set.remove();
h=(typeof a==="undefined"||a===null?undefined:a.up)||"black";e=(typeof a==="undefined"||a===null?undefined:a.down)||"red";c=typeof c!=="undefined"&&c!==null?c:5;a=this.dndata.open.length;for(g=0;0<=a?g<a:g>a;0<=a?g+=1:g-=1)if(typeof(f=this.dndata.close[g])!=="undefined"&&f!==null){k=this.dndata.close[g][1]<this.dndata.open[g][1];j={};f=this.rawdata;for(m in f)if(o.call(f,m))j[m]=this.rawdata[m][g];this.set.push(this.r.sai.prim.candlestick(this.dndata.open[g][0],k&&this.dndata.close[g][1]||this.dndata.open[g][1],
k&&this.dndata.open[g][1]||this.dndata.close[g][1],this.dndata.high[g][1],this.dndata.low[g][1],c||5,g&&typeof(f=this.dndata.close[g-1])!=="undefined"&&f!==null&&this.dndata.close[g-1][1]<this.dndata.close[g][1]?e:h,!k,b,d,Sai.util.infoSetters(d,j)))}return this};Sai.BarPlot=function(){return Sai.Plot.apply(this,arguments)};p(Sai.BarPlot,Sai.Plot);Sai.BarPlot.prototype.render=function(a,c,b,d,f){var e,h,g,j,m,k,n;this.set.remove();c=this.denormalize([0,c])[1];m=0;h=[];e=a?this.r.sai.prim.stackedBar:
this.r.sai.prim.groupedBar;a=this.dndata;for(n in a)if(o.call(a,n)){m=this.dndata[n].length;h.push((typeof b==="undefined"||b===null?undefined:b[n])||"black")}for(g=0;0<=m?g<m:g>m;0<=m?g+=1:g-=1){b=[];a=this.dndata;for(n in a)o.call(a,n)&&b.push(this.dndata[n][g]);j={};a=this.rawdata;for(k in a)if(o.call(a,k))j[k]=this.rawdata[k][g];this.set.push(e(b,h,this.w/m,c,d,f,Sai.util.infoSetters(f,j)))}return this};Sai.GeoPlot=function(){return Sai.Plot.apply(this,arguments)};p(Sai.GeoPlot,Sai.Plot);Sai.GeoPlot.prototype.getRegionColor=
function(a,c,b){return Sai.util.multiplyColor(a[b],(this.data[b][c]==null?undefined:this.data[b][c][1])||0,this.opts.fromWhite,this.opts.fromWhite?0.2:0).str};Sai.GeoPlot.prototype.getRegionOpacity=function(a,c){var b;return typeof(b=this.data[c][a]==null?undefined:this.data[c][a][1])!=="undefined"&&b!==null?1:this.opts.fromWhite?0.15:0.25};Sai.GeoPlot.prototype.render=function(a,c,b,d,f,e,h){var g,j,m,k,n,q,l;this.set.remove();n=[];k=this.rawdata[b];g=0;for(m=k.length;g<m;g++){q=k[g];n.push(q.toUpperCase())}l=
{};k=n.length;for(g=0;0<=k?g<k:g>k;0<=k?g+=1:g-=1)l[n[g]]=g;k=c.paths;for(j in k)o.call(k,j)&&function(){var t,r,s,u,v,z=j;v=l[z];s=c.name[z];s={region:typeof s!=="undefined"&&s!==null?s:z};t=this.rawdata;for(r in t)if(o.call(t,r))if(r!==b)s[r]=this.rawdata[r][v];r=this.getRegionColor(a,v,d);v=this.getRegionOpacity(v,d);u=Sai.util.infoSetters(h,s);return this.set.push(this.r.sai.prim.hoverShape(function(y,B,w,C){return function(x){return x.path(y).translate(w,C).scale(B,B,w,C)}}(c.paths[z],Math.min(this.w/
c.width,this.h/c.height),this.x,this.y-this.h),{fill:r,stroke:this.opts.fromWhite?"black":f,"stroke-width":0.5,opacity:v},e?[function(y){navigator.userAgent.toLowerCase().indexOf("msie")!==-1||navigator.userAgent.toLowerCase().indexOf("opera")!==-1||y.toFront();return u[0]()},u[1]]:null,e?[{"fill-opacity":0.75,"stroke-width":this.opts.fromWhite?1.5:0.5},{"fill-opacity":1,"stroke-width":0.5}]:null))}.call(this);k=this.set.getBBox();this.set.translate((this.w-k.width)/2,(this.h-k.height)/2);return this};
Sai.ChromaticGeoPlot=function(){return Sai.GeoPlot.apply(this,arguments)};p(Sai.ChromaticGeoPlot,Sai.GeoPlot);Sai.ChromaticGeoPlot.prototype.getRegionColor=function(a,c){var b,d,f,e,h,g;e=f=d=0;b=this.data;for(g in b)if(o.call(b,g)){h=Sai.util.multiplyColor(a[g],(this.data[g][c]==null?undefined:this.data[g][c][1])||0,this.opts.fromWhite);e+=h.r;f+=h.g;d+=h.b}return"rgb("+e+", "+f+", "+d+")"};Sai.ChromaticGeoPlot.prototype.getRegionOpacity=function(a){var c,b,d;c=this.data;for(d in c)if(o.call(c,d))if(typeof(b=
this.data[d][a]==null?undefined:this.data[d][a][1])!=="undefined"&&b!==null)return 1;return 0.25};Sai.ScatterPlot=function(){return Sai.Plot.apply(this,arguments)};p(Sai.ScatterPlot,Sai.Plot);Sai.ScatterPlot.prototype.render=function(a,c,b,d,f,e,h){var g,j,m,k,n,q;this.set.remove();j=this.dndata;for(n in j)if(o.call(j,n)){g=j[n];k=this.dndata[n].length;break}m=function(l,t,r){return t*r+l*(1-r)};q=i(function(l){return this.x+this.w*((l-this.y)/-this.h)},this);for(g=0;0<=k?g<k:g>k;0<=k?g+=1:g-=1)(function(){var l,
t,r,s,u,v,z,y,B,w,C,x=g;w=q(this.dndata[a.x]==null?undefined:this.dndata[a.x][x][1]);C=this.dndata[a.y]==null?undefined:this.dndata[a.y][x][1];r=c instanceof Array&&typeof(l=a.color)!=="undefined"&&l!==null?Sai.util.colerp(c[0],c[1],typeof(l=this.data[a.color]==null?undefined:this.data[a.color][x]==null?undefined:this.data[a.color][x][1])!=="undefined"&&l!==null?l:0):c instanceof Object&&typeof(l=a.color)!=="undefined"&&l!==null?c[this.rawdata[a.color][x]]:"black";y=f instanceof Array&&typeof(l=a.stroke_color)!==
"undefined"&&l!==null?Sai.util.colerp(f[0],f[1],typeof(l=this.data[a.stroke_color]==null?undefined:this.data[a.stroke_color][x]==null?undefined:this.data[a.stroke_color][x][1])!=="undefined"&&l!==null?l:0):c instanceof Object&&typeof(l=a.color)!=="undefined"&&l!==null?f[this.rawdata[a.stroke_color][x]]:"black";v=b instanceof Array&&typeof(l=a.radius)!=="undefined"&&l!==null?m(b[0],b[1],typeof(l=this.data[a.radius]==null?undefined:this.data[a.radius][x]==null?undefined:this.data[a.radius][x][1])!==
"undefined"&&l!==null?l:0):b instanceof Object&&typeof(l=a.radius)!=="undefined"&&l!==null?b[this.rawdata[a.radius][x]]:5;B=d instanceof Array&&typeof(l=a.stroke_opacity)!=="undefined"&&l!==null?m(d[0],d[1],typeof(l=this.data[a.stroke_opacity]==null?undefined:this.data[a.stroke_opacity][x]==null?undefined:this.data[a.stroke_opacity][x][1])!=="undefined"&&l!==null?l:0):d instanceof Object&&typeof(l=a.stroke_opacity)!=="undefined"&&l!==null?d[this.rawdata[a.stroke_opacity][x]]:1;if(e){s={};l=this.rawdata;
for(z in l)if(o.call(l,z))z.match("^__")||(s[z]=this.rawdata[z][x]);u=Sai.util.infoSetters(h,s)}return this.set.push(t=this.r.circle(w,C,v).attr({fill:r,"stroke-opacity":B,stroke:y,"fill-opacity":0.8,"stroke-width":2}),e?t.hover(function(){u[0]();return this.attr("fill-opacity",0.5)},function(){u[1]();return this.attr("fill-opacity",0.8)}):null)}).call(this);return this}}).call(this);(function(){var o=Object.prototype.hasOwnProperty,p=function(a,c){return function(){return a.apply(c,arguments)}},i=function(a,c){var b=function(){};b.prototype=c.prototype;a.prototype=new b;a.prototype.constructor=a;typeof c.extended==="function"&&c.extended(a);a.__super__=c.prototype};Sai.Chart=function(a,c,b,d,f,e,h,g){var j;this.opts=g;this.__LABELS__=h;this.h=f;this.w=d;this.y=b;this.x=c;this.r=a;j=this;this.drawInfo=function(){return Sai.Chart.prototype.drawInfo.apply(j,arguments)};this.opts=
typeof this.opts!=="undefined"&&this.opts!==null?this.opts:{};this.opts.bgcolor=typeof this.opts.bgcolor!=="undefined"&&this.opts.bgcolor!==null?this.opts.bgcolor:"white";this.setData(e);this.padding={left:5,right:5,top:5,bottom:5};return this};Sai.Chart.prototype.groupsToNullPad=function(){return[]};Sai.Chart.prototype.nonNegativeGroups=function(){return[]};Sai.Chart.prototype.nextSeriesSuffix=function(){var a;this.suffixCtr=(typeof(a=this.suffixCtr)!=="undefined"&&a!==null?a:0)+1;return"["+this.suffixCtr+
"]"};Sai.Chart.prototype.fixSeriesName=function(a){return a+(a.match(/^\s+$/)?this.nextSeriesSuffix():"")};Sai.Chart.prototype.setSemanticRename=function(a){var c,b,d;if(!(typeof(c=this.semanticRenamePatterns)!=="undefined"&&c!==null))return null;this.semanticRenames=typeof this.semanticRenames!=="undefined"&&this.semanticRenames!==null?this.semanticRenames:{};b=[];c=this.semanticRenamePatterns;for(d in c)if(o.call(c,d))b.push(a.match(this.semanticRenamePatterns[d])?this.semanticRenames[d]=a:null);
return b};Sai.Chart.prototype.setData=function(a){var c,b,d,f,e,h,g,j,m,k,n,q;this.data={};this.renames={};if(function(r){var s;for(s in r)if(o.call(r,s))if(r.hasOwnProperty(s))return false;return true}(a)){this.render=function(){return this.showError("(no data -> empty chart)")};return null}e=a;for(n in e)if(o.call(e,n)){for(c=e[n];;){q=this.fixSeriesName(n);this.setSemanticRename(q);if(q===n||!(q in a))break}this.renames[n]=q;if(a[n]instanceof Array)if(this.__LABELS__===n){this.__LABELS__=q;var l=
this.data,t=q;c=[];h=a[n];b=0;for(d=h.length;b<d;b++){g=h[b];c.push(String(g))}l[t]=c}else{l=this.data;t=q;c=[];h=a[n];b=0;for(d=h.length;b<d;b++){g=h[b];c.push(typeof g==="string"&&g.match(/^[+-]?[\d,]+(\.\d+)?$/)&&!isNaN(m=parseFloat(g.replace(/,/g,"")))?m:g)}l[t]=c}else this.data[q]=a[n]}a=this.dataGroups(this.data);k=this.nonNegativeGroups();e=a;for(j in e)if(o.call(e,j)){c=e[j];if(a[j].length>0)if(function(){for(var r=0,s=k.length;r<s;r++)if(k[r]===j)return true;return false}.call(this)){h=a[j];
b=0;for(d=h.length;b<d;b++){n=h[b];if(typeof(f=this.data[n])!=="undefined"&&f!==null){f=this.data[n].length;for(m=0;0<=f?m<f:m>f;0<=f?m+=1:m-=1)if(this.data[n][m]<0)this.data[n][m]*=-1}}}}e=this.groupsToNullPad();c=0;for(d=e.length;c<d;c++){j=e[c];if(j in a){h=a[j];b=0;for(f=h.length;b<f;b++){n=h[b];this.nullPad(n)}}}return this.normalize(this.data)};Sai.Chart.prototype.nullPad=function(a){return a in this.data?this.data[a]=[null].concat(this.data[a].concat([null])):null};Sai.Chart.prototype.caresAbout=
function(a){return!(a.match("^__")||a===this.__LABELS__)};Sai.Chart.prototype.dataGroups=function(a){var c,b,d,f;b=[];c=a;for(d in c)o.call(c,d)&&this.caresAbout(d)&&b.push(d);f=b;b=[];c=a;for(d in c)if(o.call(c,d))if(d.match("^__")||d===this.__LABELS__)b.push(d);return{all:f,__META__:b}};Sai.Chart.prototype.getYAxisVals=function(a,c,b){var d,f,e;if(!(typeof a==="number"&&typeof c==="number"))return[a,c];if(a===c)return[0,c,c*2];b=typeof b!=="undefined"&&b!==null?b:false;for(d=1;(c-a)*d<10;)d*=10;
a*=d;c*=d;e=Math.floor(f=Math.log(c-a)/Math.LN10-0.4);e=Math.pow(10,e);if(f%1>0.7&&!b)e*=4;else if(f%1>0.35&&!b)e*=2;f=Sai.util.round(a-(b?e/2.1:e/1.75),e);if(f<0&&0<=a)f=0;a=Sai.util.round(c+(b?e/2.1:e/1.75),e);f/=d;a/=d;e/=d;d=[];for(c=f;f<=a?c<=a:c>=a;c+=e)d.push(Sai.util.round(c,e));return d};Sai.Chart.prototype.getMax=function(a,c){var b,d,f,e,h,g,j,m,k;return Math.max.apply(Math,function(){g=[];b=0;for(f=c.length;b<f;b++){k=c[b];if(typeof(h=a[k])!=="undefined"&&h!==null)g.push(Math.max.apply(Math,
function(){j=[];h=a[k];d=0;for(e=h.length;d<e;d++){m=h[d];typeof m!=="undefined"&&m!==null&&typeof m==="number"&&j.push(m)}return j}()))}return g}())};Sai.Chart.prototype.getMin=function(a,c){var b,d,f,e,h,g,j,m,k;return Math.min.apply(Math,function(){g=[];b=0;for(f=c.length;b<f;b++){k=c[b];if(typeof(h=a[k])!=="undefined"&&h!==null)g.push(Math.min.apply(Math,function(){j=[];h=a[k];d=0;for(e=h.length;d<e;d++){m=h[d];typeof m!=="undefined"&&m!==null&&typeof m==="number"&&j.push(m)}return j}()))}return g}())};
Sai.Chart.prototype.getStackedMax=function(a,c){var b,d,f,e,h,g,j;return Math.max.apply(Math,function(){e=[];f=a[this.__LABELS__].length;for(g=0;0<=f?g<f:g>f;0<=f?g+=1:g-=1)e.push(Sai.util.sumArray(function(){h=[];b=0;for(d=c.length;b<d;b++){j=c[b];j!==this.__LABELS__&&a[j][g]>=0&&h.push(a[j][g])}return h}.call(this)));return e}.call(this))};Sai.Chart.prototype.getStackedMin=function(a,c){var b,d,f,e,h,g,j;return Math.min.apply(Math,function(){e=[];f=a[this.__LABELS__].length;for(g=0;0<=f?g<f:g>f;0<=
f?g+=1:g-=1)e.push(Sai.util.sumArray(function(){h=[];b=0;for(d=c.length;b<d;b++){j=c[b];j!==this.__LABELS__&&a[j][g]<0&&h.push(a[j][g])}return h}.call(this)));return e}.call(this))};Sai.Chart.prototype.normalize=function(a){var c,b,d,f,e,h,g,j,m,k,n,q,l,t,r,s,u,v,z,y,B,w,C;r=this.dataGroups(a);this.ndata={};if(typeof(f=this.opts.stacked)!=="undefined"&&f!==null)this.stackedNdata={};z=function(x,A,D){if(typeof x==="number")return A===D?1:(x-A)/(D-A);return null};m=function(x,A){var D,E,F;D=0;for(E=
A.length;D<E;D++){F=A[D];if(!x(F))return false}return true};l=function(x){var A,D,E;A=0;for(D=x.length;A<D;A++){E=x[A];if(typeof E==="number")return false}return true};f=r;for(c in f)if(o.call(f,c)){t=c;if(!(v=t.match("^__"))){if(!(v=Sai.util.sumArray(function(){j=[];e=r[t];b=0;for(d=e.length;b<d;b++){w=e[b];j.push(this.data[w].length)}return j}.call(this))===0)){v=m;s=l;j=[];e=r[t];b=0;for(d=e.length;b<d;b++){w=e[b];j.push(this.data[w])}v=v(s,j)}v=v}if(!v){this.ndata[t]={};if(typeof(e=this.opts.stacked)!==
"undefined"&&e!==null){this.stackedNdata[t]={};n={}}v=this.opts.stacked?p(function(x,A){return this.getStackedMin(x,A)},this):this.getMin;s=this.opts.stacked?p(function(x,A){return this.getStackedMax(x,A)},this):this.getMax;v=v(a,r[t]);u=s(a,r[t]);C=this.getYAxisVals(v,u);v=C[0];u=C[C.length-1];e=r[t];b=0;for(d=e.length;b<d;b++){w=e[b];if(typeof(h=a[w])!=="undefined"&&h!==null){q=this.ndata[t];y=w;j=[];h=a[w].length;for(s=0;0<=h?s<h:s>h;0<=h?s+=1:s-=1)j.push(typeof(g=a[w][s])!=="undefined"&&g!==null&&
(B=z(a[w][s],v,u))!==null?[s/(a[w].length-1||1),B]:null);q[y]=j;if(typeof(h=this.opts.stacked)!=="undefined"&&h!==null){y=z(0,v,u);this.stackedNdata[t][w]=[];h=a[w].length;for(s=0;0<=h?s<h:s>h;0<=h?s+=1:s-=1){q=typeof(g=a[w][s])!=="undefined"&&g!==null&&a[w][s]<0?0:1;n[s]=typeof n[s]!=="undefined"&&n[s]!==null?n[s]:[y,y];k=n[s][q];k=[s/(a[w].length-1||1),(typeof(g=z(a[w][s],v,u))!=="undefined"&&g!==null?g:y)+k-y];this.stackedNdata[t][w].push(k);if(k!==null)n[s][q]=k[1]}}this.ndata[t].__YVALS__=C}}}}return[]};
Sai.Chart.prototype.addAxes=function(a,c){var b,d,f,e,h,g;this.axisWidth=1.5;this.padding.top+=5;for(e=this.data[this.__LABELS__].length-1;this.data[this.__LABELS__].length-1<=0?e<=0:e>=0;this.data[this.__LABELS__].length-1<=0?e+=1:e-=1)if(typeof(b=this.data[this.__LABELS__][e])!=="undefined"&&b!==null){e=this.r.text(0,0,Sai.util.prettystr(this.data[this.__LABELS__][e]));this.padding.right+=e.getBBox().width/2;e.remove();break}h=this.h-(this.padding.bottom+this.padding.top);f=typeof(b=this.ndata[a[0]])!==
"undefined"&&b!==null||!(typeof(b=this.ndata[a[1]])!=="undefined"&&b!==null);e=typeof(b=this.ndata[a[1]])!=="undefined"&&b!==null;if(f){d=this.r.sai.prim.vaxis(typeof(b=this.ndata[a[0]]==null?undefined:this.ndata[a[0]].__YVALS__)!=="undefined"&&b!==null?b:[0,"?"],this.x+this.padding.left,this.y-this.padding.bottom,h,{width:this.axisWidth,title:typeof c==="undefined"||c===null?undefined:c.left});g=d.items[0].getBBox().width;d.remove()}else g=0;if(e){d=this.r.sai.prim.vaxis(typeof(b=this.ndata[a[1]]==
null?undefined:this.ndata[a[1]].__YVALS__)!=="undefined"&&b!==null?b:[0,"?"],this.x+this.padding.left,this.y-this.padding.bottom,h,{width:this.axisWidth,title:typeof c==="undefined"||c===null?undefined:c.right});h=d.getBBox().width;d.remove()}else h=0;this.haxis=this.r.sai.prim.haxis(this.data[this.__LABELS__],this.x+this.padding.left+g,this.y-this.padding.bottom,this.w-this.padding.left-this.padding.right-g-h,{width:this.axisWidth,title:typeof c==="undefined"||c===null?undefined:c.bottom});d=this.haxis.getBBox().height;
if(isNaN(d))d=1;this.haxis.translate(0,-d);this.padding.bottom+=d;h=this.h-(this.padding.bottom+this.padding.top);if(f){this.vaxis=this.r.sai.prim.vaxis(typeof(b=this.ndata[a[0]]==null?undefined:this.ndata[a[0]].__YVALS__)!=="undefined"&&b!==null?b:[0,"?"],this.x+this.padding.left,this.y-this.padding.bottom,h,{width:this.axisWidth,title:typeof c==="undefined"||c===null?undefined:c.left});f=this.vaxis.items[0].getBBox().width;this.vaxis.translate(f,0);this.padding.left+=f}if(e){this.vaxis_right=this.r.sai.prim.vaxis(typeof(b=
this.ndata[a[1]]==null?undefined:this.ndata[a[1]].__YVALS__)!=="undefined"&&b!==null?b:[0,"?"],this.w-this.padding.right,this.y-this.padding.bottom,h,{width:this.axisWidth,right:true,title:typeof c==="undefined"||c===null?undefined:c.right,color:typeof(b=this.ndata[a[0]])!=="undefined"&&b!==null?typeof(b=this.colors.__RIGHTAXIS__)!=="undefined"&&b!==null?b:"blue":"black"});b=this.vaxis_right.items[0].getBBox().width;this.vaxis_right.translate(-b,0);this.padding.right+=b}this.setPlotCoords();return this.r.set().push(this.haxis).push(this.vaxis)};
Sai.Chart.prototype.setPlotCoords=function(){var a;this.px=this.x+this.padding.left;this.py=this.y-this.padding.bottom;this.pw=this.w-this.padding.left-this.padding.right;this.ph=this.h-this.padding.bottom-this.padding.top;a=this.legend==null?undefined:this.legend.getBBox();this.legend==null||this.legend.translate(this.px+this.pw/2-(a.x+a.width/2),0);a=this.histogramLegend==null?undefined:this.histogramLegend.getBBox();return this.histogramLegend==null?undefined:this.histogramLegend.translate(this.px+
this.pw/2-(a.x+a.width/2),0)};Sai.Chart.prototype.drawBG=function(){var a;return this.bg=this.r.rect(typeof(a=this.px)!=="undefined"&&a!==null&&this.px||this.x,typeof(a=this.py)!=="undefined"&&a!==null&&this.py-this.ph||this.y-this.h,typeof(a=this.pw)!=="undefined"&&a!==null&&this.pw||this.w,typeof(a=this.ph)!=="undefined"&&a!==null&&this.ph||this.h).attr({fill:this.opts.bgcolor,"stroke-width":0,"stroke-opacity":0}).toBack()};Sai.Chart.prototype.logoPos=function(){var a,c,b;c=typeof(a=this.px)!==
"undefined"&&a!==null&&typeof(a=this.pw)!=="undefined"&&a!==null?this.px+this.pw-150-5:this.w+this.x-150-this.padding.right;b=typeof(a=this.py)!=="undefined"&&a!==null&&typeof(a=this.ph)!=="undefined"&&a!==null?this.py-this.ph+5:this.y-this.h+this.padding.top;return[c,b,150,28]};Sai.Chart.prototype.drawLogo=function(){var a,c,b,d,f,e,h;a=this.logoPos();e=a[0];h=a[1];f=a[2];c=a[3];b=[328.3,53.06];d=[f/344,c/65];e+=b[0]*d[0];h+=b[1]*d[1];return this.logo=this.r.path("M"+e+","+h+"h1.9v1.6c0.5-0.5,0.9-0.9,1.3-1.2,0.6-0.4,1.4-0.7,2.2-0.7,0.9,0,1.6,0.3,2.2,0.7,0.3,0.3,0.6,0.7,0.9,1.2,0.4-0.7,0.9-1.1,1.5-1.4,0.6-0.3,1.2-0.5,2-0.5,1.5,0,2.6,0.6,3.1,1.7,0.3,0.6,0.5,1.4,0.5,2.5v7.7h-2v-8.1c0-0.7-0.2-1.3-0.6-1.6-0.4-0.2-0.9-0.4-1.4-0.4-0.8,0-1.4,0.3-2,0.8-0.5,0.5-0.8,1.3-0.8,2.5v6.8h-2v-7.6c0-0.8-0.1-1.3-0.3-1.7-0.3-0.5-0.8-0.8-1.6-0.8-0.8,0-1.4,0.3-2,0.8-0.6,0.6-0.9,1.6-0.9,3.1v6.2h-2v-11.6zm-3.9,1.1c1,1,1.5,2.5,1.5,4.4,0,1.9-0.4,3.4-1.3,4.7-0.9,1.2-2.3,1.8-4.2,1.8-1.6,0-2.9-0.6-3.8-1.6-0.9-1.1-1.4-2.6-1.4-4.4,0-1.9,0.5-3.5,1.5-4.6,1-1.2,2.3-1.7,3.9-1.7,1.5,0,2.8,0.5,3.8,1.4zm-1.2,7.7c0.5-0.9,0.7-2,0.7-3.2,0-1.1-0.2-2-0.5-2.6-0.6-1.1-1.5-1.6-2.8-1.6-1.2,0-2,0.4-2.6,1.3-0.5,0.9-0.8,2-0.8,3.3,0,1.2,0.3,2.2,0.8,3.1,0.6,0.8,1.4,1.2,2.6,1.2,1.2,0,2.1-0.5,2.6-1.5zm-10.6-8.2c0.8,0.6,1.3,1.7,1.5,3.3h-1.9c-0.1-0.7-0.4-1.3-0.8-1.8-0.4-0.5-1.1-0.7-2-0.7-1.2,0-2.1,0.6-2.6,1.8-0.4,0.8-0.6,1.8-0.6,2.9,0,1.2,0.3,2.1,0.8,2.9,0.5,0.8,1.2,1.2,2.3,1.2,0.8,0,1.4-0.2,1.9-0.7,0.5-0.5,0.8-1.2,1-2h1.9c-0.2,1.5-0.8,2.6-1.7,3.3-0.8,0.7-1.9,1.1-3.3,1.1-1.5,0-2.7-0.6-3.6-1.7-0.9-1.1-1.3-2.4-1.3-4.1,0-2,0.5-3.6,1.4-4.7,1-1.2,2.3-1.7,3.8-1.7,1.3,0,2.4,0.3,3.2,0.9zm-13.3,8.6h2.2v2.4h-2.2v-2.4zm-181-15.8-6,12.9h-7.6c-0.9-0.4-4.5-6-5.3-7.2-3.3-4.5-6.8-8.9-10.1-13.5-1.2-1.7-2.8-3.2-4-5.1h-8.9v-2.8h17.7c3.4,0,7.2,0.3,9.6-0.8,2.2-0.9,3.9-2.5,5.2-4.3,1.1-1.7,2.8-4.6,2.1-8-1.2-4.9-4-7.791-8.5-9.251-2.6-0.81-9.8-0.61-9.8-0.61h-21v56.361h4.7v-26h6.5c6.4,8.6,12.9,17.3,19.3,26h12.9l6.5-13.1h34.5l6.4,13.1h5.4l-8.6-17.7h-41zm-41.9-34.10h17.7c4.5,0,7.8-0.1,10,2.1,1.1,1.1,2.8,3.2,2.1,5.9-0.5,2.2-1.9,4-3.9,4.8-2,0.9-5.8,0.7-8.4,0.7h-17.5v-13.50zm61.1-4.751-17.4,36.051h37.5l-17.4-36.051h-2.7zm-9.9,31.251,11-22.9,11.4,22.9h-22.4zm-127.60-26.500h25.800v51.8h4.7v-56.361h-30.500v4.561zm276.70-12.341-35.6,29.741v-29.741h-4.8v39.441l48-39.441h-7.6zm19.4,0h-7.4l-32.3,26.941,32.3,37.2h6.2l-31.6-36.400,32.8-27.741zm-163.3,0-25.1,50.841-5.9-7.8-3.4-4.5v-0.4c9.7,0,16-4.9,18.8-11.6,4.8-11.3-2.7-21.961-10.4-25.211-3.4-1.44-8-1.33-12.9-1.33h-20.3h-73.600v4.74h64.100v2.97l-30.7,0.1v56.331h4.7v-51.8h26v51.8h4.7v-59.401h22.8c4,0,8.8-0.46,12,0.57,3.4,1.12,5.9,3.35,7.7,6.031,1.7,2.6,3.5,7.2,2.1,11.6-0.7,2.3-1.9,4.2-3.2,5.9-1.3,1.7-4.4,3.4-6.6,4.2-1,0.3-3.1,0.5-3.1,0.5h-11.5c5.6,7.7,11.3,15.3,17,23h4.4c0.6-0.4,25-50.151,25.4-51.801h6.1l29.2,59.401h5.1l-31.3-64.141h-12.1zm103.5,43.641v20.5h4.8v-18.2l12.5-10.5,25,28.7h6.3l-30.6-35.1-18,14.6zm-7.7-28.3c-6.1-9.141-17.1-15.251-29.6-15.251-19.2,0-34.8,14.351-34.8,32.151,0,17.7,15.6,32.1,34.8,32.1,10.5,0,22.4-4.1,29.7-10.8v10.6h4.8v-19c-1.7,0.8-3.3,1.8-4.9,2.8v0.1c-10.9,7.1-19.4,11.2-29.9,11.3-16.4,0-29.6-12.2-29.6-27.2,0-15.1,13.2-27.311,29.6-27.311,11.5,0,21.5,6.011,26.4,14.811,0,0,2.2-1.4,3.5-2.2v20.8c-1.3,0.9-4.5,3.3-4.6,3.4-8.2,5.4-17.9,10.3-25.5,10.4-12,0-21.7-9-21.7-19.9,0-11,9.7-19.9,21.7-19.9,8.4,0,15.7,4.4,19.3,10.8l0.1,0.1c0.2,0.2,0.5,0.2,0.7,0.1,0,0,0.1-0.1,0.1-0.1,0.1-0.1,0.9-0.6,1.7-1,0.4-0.3,0.8-0.5,1.1-0.7,0.1,0,0.2-0.1,0.3-0.2h0.1l0.1-0.1c0.2-0.1,0.3-0.5,0.1-0.7-4.5-7.8-13.3-12.971-23.4-12.971-14.8,0-26.7,11.071-26.7,24.771,0,13.7,11.9,24.7,26.7,24.7,9.6,0,25.4-8.1,29.9-12.2,1.6-1.1,3.1-2.4,4.9-3.2v-41.561h-4.9v15.361z").hide().attr({fill:typeof(a=
this.opts.logoColor)!=="undefined"&&a!==null?a:"#AA5128","stroke-width":0,"stroke-opacity":0,opacity:0.25,cx:e+f/2,cy:h-c/2}).scale(d[0],d[1],e,h).show()};Sai.Chart.prototype.drawFootnote=function(a){var c;a=typeof a!=="undefined"&&a!==null?a:typeof(c=this.opts.footnote)!=="undefined"&&c!==null?c:"";if(a.match(/^\s*$/))return null;this.footnote=this.r.sai.prim.wrappedText(this.x+this.padding.left,this.y-this.padding.bottom,this.w,a," ");a=this.footnote.getBBox().height;this.padding.bottom+=a+10;return this.footnote.translate(0,
-a)};Sai.Chart.prototype.render=function(){var a;this.opts.simple&&typeof(a=this.renderPlots)!=="undefined"&&a!==null?this.renderPlots():this.renderFull();return this};Sai.Chart.prototype.renderFull=function(){this.plot=typeof this.plot!=="undefined"&&this.plot!==null?this.plot:new Sai.Plot(this.r);this.plot.render();return this};Sai.Chart.prototype.showError=function(a){var c;return this.r.text(this.x+this.padding.left+(typeof(c=this.pw)!=="undefined"&&c!==null?c:this.w)/2,this.y-this.padding.bottom-
(typeof(c=this.ph)!=="undefined"&&c!==null?c:this.h)/2,a)};Sai.Chart.prototype.setColors=function(a){var c,b;this.colors=typeof this.colors!=="undefined"&&this.colors!==null?this.colors:{};for(c in a)if(o.call(a,c)){b=this.renames[c];if(b in this.data)this.colors[b]=a[c]}return this};Sai.Chart.prototype.setColor=function(a,c){this.colors=typeof this.colors!=="undefined"&&this.colors!==null?this.colors:{};this.colors[this.renames[a]]=c;return this};Sai.Chart.prototype.normalizedHeight=function(a,c){var b;
if(!(typeof(b=this.ndata[c]==null?undefined:this.ndata[c].__YVALS__)!=="undefined"&&b!==null))return null;b=this.ndata[c].__YVALS__[0];if(!(a>b))return null;return(a-b)/(this.ndata[c].__YVALS__[this.ndata[c].__YVALS__.length-1]-b)};Sai.Chart.prototype.drawGuideline=function(a,c){var b;c=typeof c!=="undefined"&&c!==null?c:"all";if(!(typeof(b=this.ndata[c]==null?undefined:this.ndata[c].__YVALS__)!=="undefined"&&b!==null))return null;b=this.normalizedHeight(a,c);this.guidelines=typeof this.guidelines!==
"undefined"&&this.guidelines!==null?this.guidelines:this.r.set();b=new Sai.LinePlot(this.r,this.px,this.py,this.pw,this.ph,{guideline:[[0,b],[1,b]]});b.render({guideline:"#ccc"});return this.guidelines.push(b.set)};Sai.Chart.prototype.drawLegend=function(a){var c,b,d,f,e;if(a=typeof a!=="undefined"&&a!==null?a:this.colors){c={};b={};d=a;for(e in d)if(o.call(d,e))if(e!==this.__LABELS__){c[e]=a[e];b[e]="black";if(typeof(f=this.opts.groups==null?undefined:this.opts.groups.right)!=="undefined"&&f!==null)if(function(){for(var h=
0,g=(f=this.opts.groups.right).length;h<g;h++)if(f[h]===e)return true;return false}.call(this))b[e]=typeof(f=this.ndata.left)!=="undefined"&&f!==null?typeof(f=this.colors.__RIGHTAXIS__)!=="undefined"&&f!==null?f:"blue":"black"}this.legend=this.r.sai.prim.legend(this.x,this.y-this.padding.bottom,this.w,c,b);a=this.legend.getBBox();if(this.legend.length>0)this.padding.bottom+=a.height+15;return this.legend.translate((this.w-a.width)/2,0)}};Sai.Chart.prototype.drawTitle=function(){var a;if(typeof(a=
this.opts.title)!=="undefined"&&a!==null){this.title=this.r.text(this.x+this.w/2,this.y-this.h,this.opts.title).attr({"font-size":20});this.title.translate(0,this.title.getBBox().height/2);return this.padding.top+=this.title.getBBox().height+5}};Sai.Chart.prototype.setupInfoSpace=function(){this.info_y=this.y-this.h+this.padding.top;this.info_x=this.x+this.padding.left;this.info_w=this.w-this.padding.left-this.padding.right;return this.padding.top+=30};Sai.Chart.prototype.drawInfo=function(a,c){var b,
d,f;c=typeof c!=="undefined"&&c!==null?c:true;a=typeof a!=="undefined"&&a!==null?a:typeof(b=this.default_info)!=="undefined"&&b!==null?this.default_info():{};if(c)this.info_data={};this.info&&this.info.remove();b=a;for(f in b)if(o.call(b,f))f.match("^__")||(this.info_data[f]=typeof(d=a[f])!=="undefined"&&d!==null?d:"(no data)");return this.info=this.r.sai.prim.info(this.info_x,this.info_y,this.info_w,this.info_data)};Sai.Chart.prototype.getIndex=function(a){a=Sai.util.transformCoords(a,this.r.canvas).x;
return Math.round((this.data[this.__LABELS__].length-1)*(a-this.px)/this.pw)};Sai.Chart.prototype.drawHistogramLegend=function(a,c){var b,d,f,e,h,g,j,m,k,n,q,l;c=typeof c!=="undefined"&&c!==null?c:this.colors;this.histogramLegend=this.r.set();m=Math.max(0.1*(this.h-this.padding.bottom-this.padding.top),50);q=Math.min(150,(this.w-this.padding.left-this.padding.right-20)/a.length);f=a.length;for(k=0;0<=f?k<f:k>f;0<=f?k+=1:k-=1){n=a[k];g=[];e=this.ndata[n][n].length;for(j=0;0<=e?j<e:j>e;0<=e?j+=1:j-=
1)if(typeof(h=this.ndata[n][n][j])!=="undefined"&&h!==null)g.push(this.ndata[n][n][j][1]);j=g;if(typeof(e=this.bounds==null?undefined:this.bounds[n])!=="undefined"&&e!==null)e=this.bounds[n];else{g=[];e=this.data[n];b=0;for(d=e.length;b<d;b++){l=e[b];typeof l!=="undefined"&&l!==null&&g.push(l)}e=g;e=[Math.min.apply(Math,e),Math.max.apply(Math,e)]}g=e[0];e=e[1];g=this.getYAxisVals(g,e,true);e=g[0];b=g[g.length-1];g=c[n];this.histogramLegend.push(j=this.r.sai.prim.histogram(this.x+k*q,this.y-this.padding.bottom,
q*0.8,m,j,e,b,n,typeof g==="object"?[g.__LOW__,g.__HIGH__]:[g],"white",this.opts.fromWhite));this.opts.interactive&&this.setupHistogramInteraction(j,n)}this.histogramLegend.translate((this.w-this.padding.left-this.padding.right-this.histogramLegend.getBBox().width)/2,0);return this.padding.bottom+=m+5};Sai.Chart.prototype.setupHistogramInteraction=function(){return null};Sai.LineChart=function(){return Sai.Chart.apply(this,arguments)};i(Sai.LineChart,Sai.Chart);Sai.LineChart.prototype.nonNegativeGroups=
function(){return this.opts.stacked?["all","left","right"]:[]};Sai.LineChart.prototype.dataGroups=function(){var a,c,b,d,f,e;f=Sai.LineChart.__super__.dataGroups.apply(this,arguments);if(typeof(b=this.opts.groups==null?undefined:this.opts.groups.left)!=="undefined"&&b!==null&&typeof(b=this.opts.groups==null?undefined:this.opts.groups.right)!=="undefined"&&b!==null){d=[];b=this.opts.groups.left;a=0;for(c=b.length;a<c;a++){e=b[a];this.caresAbout(e)&&e in this.data&&d.push(e)}f.left=d;d=[];b=this.opts.groups.right;
a=0;for(c=b.length;a<c;a++){e=b[a];this.caresAbout(e)&&e in this.data&&d.push(e)}f.right=d}return f};Sai.LineChart.prototype.renderPlots=function(){var a,c,b,d;typeof(a=this.px)!=="undefined"&&a!==null||this.setPlotCoords();this.drawBG();this.drawLogo();d="right"in this.ndata;c=typeof(a=this.opts.stacked)!=="undefined"&&a!==null?this.stackedNdata:this.ndata;b=this.opts.area?Sai.AreaPlot:Sai.LinePlot;if(d){if((this.ndata.left==null?undefined:this.ndata.left.__YVALS__[0])<0)this.drawGuideline(0,"left");
if((this.ndata.right==null?undefined:this.ndata.right.__YVALS__[0])<0)this.drawGuideline(0,"right")}else this.ndata.all.__YVALS__[0]<0&&this.drawGuideline(0,"all");this.plots=[];if(d){if(typeof(a=c.left)!=="undefined"&&a!==null)this.plots.push((new b(this.r,this.px,this.py,this.pw,this.ph,c.left)).render(this.colors,typeof(a=this.opts.lineWidth)!=="undefined"&&a!==null?a:2,this.opts.stacked,this.normalizedHeight(0,"left")));return typeof(a=c.right)!=="undefined"&&a!==null?this.plots.push((new b(this.r,
this.px,this.py,this.pw,this.ph,c.right)).render(this.colors,typeof(a=this.opts.lineWidth)!=="undefined"&&a!==null?a:2,this.opts.stacked,this.normalizedHeight(0,"right"))):null}else return this.plots.push((new b(this.r,this.px,this.py,this.pw,this.ph,c.all)).render(this.colors,typeof(a=this.opts.lineWidth)!=="undefined"&&a!==null?a:2,this.opts.stacked,this.normalizedHeight(0,"all")))};Sai.LineChart.prototype.renderFull=function(){var a,c,b,d,f,e;this.drawTitle();this.setupInfoSpace();this.drawFootnote();
this.drawLegend();"right"in this.ndata?this.addAxes(["left","right"]):this.addAxes(["all"]);this.renderPlots();this.plotSets=this.r.set();b=this.plots;a=0;for(c=b.length;a<c;a++){f=b[a];this.plotSets.push(f.set)}this.dots=this.r.set();b=this.ndata.all;for(e in b)if(o.call(b,e)){a=b[e];if(e!=="__YVALS__")this.dots.push(this.r.circle(0,0,4).attr({fill:typeof(d=this.colors==null?undefined:this.colors[e])!=="undefined"&&d!==null?d:"black"}).hide())}a=this.r.set().push(this.bg,this.plotSets,this.dots,
this.logo,this.guidelines).mousemove(p(function(h){var g,j,m,k,n,q,l,t,r,s,u;t=this.getIndex(h);n={};if((this.data[this.__LABELS__]==null?undefined:this.data[this.__LABELS__].length)>t&&t>=0){n[this.__LABELS__]=this.data[this.__LABELS__][t];m=this.ndata.all;for(u in m)if(o.call(m,u)){h=m[u];if(typeof(k=this.data[u])!=="undefined"&&k!==null)n[u]=this.data[u][t]}}this.drawInfo(n);l=0;n=[];m=this.ndata.all;for(u in m)if(o.call(m,u)){h=m[u];u!=="__YVALS__"&&n.push(function(){q=[];k=this.plots;g=0;for(j=
k.length;g<j;g++){r=k[g];u in r.dndata&&q.push(function(){s=r.dndata[u][t];typeof s!=="undefined"&&s!==null?this.dots[l].attr({cx:s[0],cy:s[1]}).show().toFront():this.dots[l].hide();return l++}.call(this))}return q}.call(this))}return n},this)).mouseout(p(function(){this.drawInfo({},true);return this.dots.hide()},this));this.opts.href&&a.attr({href:this.opts.href,target:"_blank"});return this};Sai.Sparkline=function(){return Sai.Chart.apply(this,arguments)};i(Sai.Sparkline,Sai.Chart);Sai.Sparkline.prototype.dataGroups=
function(){return{data:["data"]}};Sai.Sparkline.prototype.renderFull=function(){this.drawBG();this.plots=this.r.set();this.plots.push((new Sai.LinePlot(this.r,this.x,this.y,this.w,this.h,this.ndata.data)).render({data:this.colors&&this.colors[series]||"black"},1).set);return this};Sai.BarChart=function(){return Sai.Chart.apply(this,arguments)};i(Sai.BarChart,Sai.Chart);Sai.BarChart.prototype.getMin=function(){return Math.min(Sai.BarChart.__super__.getMin.apply(this,arguments),0)};Sai.BarChart.prototype.groupsToNullPad=
function(){var a,c,b;c=[];a=this.dataGroups();for(b in a)o.call(a,b)&&c.push(b);return c};Sai.BarChart.prototype.tooMuchData=function(){var a,c,b,d;b=this.w/3;c=0;a=this.data;for(d in a)if(o.call(a,d))if(d!==this.__LABELS__){c+=this.data[d].length;if(this.opts.stacked)break}return c>b};Sai.BarChart.prototype.renderPlots=function(){var a,c,b,d,f;typeof(b=this.px)!=="undefined"&&b!==null||this.setPlotCoords();this.drawLogo();this.drawBG();if(this.tooMuchData()){this.showError("Sorry, the chart isn't wide enough to plot this much data.\n \nPossible solutions include downsampling your data\n (e.g. weekly instead of daily) or using a line chart");
return this}if("all"in this.ndata){this.guidelines=this.r.set();b=this.ndata.all.__YVALS__.slice(1,this.ndata.all.__YVALS__.length-1);a=0;for(c=b.length;a<c;a++){d=b[a];this.drawGuideline(d)}}this.plots=this.r.set();a={};d={};d[this.__LABELS__]=this.data[this.__LABELS__];c=typeof(b=this.opts.stacked)!=="undefined"&&b!==null?this.stackedNdata:this.ndata;b=c.all;for(f in b)if(o.call(b,f))if(!(f.match("^__")||f===this.__LABELS__)){a[f]=c.all[f];d[f]=this.data[f]}return this.plots.push((new Sai.BarPlot(this.r,
this.px,this.py,this.pw,this.ph,a,d)).render(typeof(b=this.opts.stacked)!=="undefined"&&b!==null,this.normalizedHeight(0,"all"),this.colors,this.opts.interactive&&!this.opts.simple,this.drawInfo).set)};Sai.BarChart.prototype.renderFull=function(){var a;this.drawTitle();this.setupInfoSpace();this.drawFootnote();this.drawLegend();this.addAxes(["all"]);this.renderPlots();a=this.r.set().push(this.plots,this.bg,this.logo,this.guidelines);this.opts.href&&a.attr({href:this.opts.href,target:"_blank"});return this};
Sai.StockChart=function(){return Sai.Chart.apply(this,arguments)};i(Sai.StockChart,Sai.Chart);Sai.StockChart.prototype.semanticRenamePatterns={open:/^open$/i,close:/^close$/i,high:/^high$/i,low:/^low$/i,volume:/^vol(ume)?$/i};Sai.StockChart.prototype.groupsToNullPad=function(){return["prices","volume","__META__"]};Sai.StockChart.prototype.dataGroups=function(a){var c,b,d,f;b={__META__:[this.__LABELS__]};f=typeof(c=this.semanticRenames.volume)!=="undefined"&&c!==null?c:"volume";if(f in this.data)b.volume=
[f];c=a;for(d in c)if(o.call(c,d))if(this.caresAbout(d)&&!(this.__LABELS__===d||f===d)){b.prices=typeof b.prices!=="undefined"&&b.prices!==null?b.prices:[];b.prices.push(d)}return b};Sai.StockChart.prototype.nonNegativeGroups=function(){return["volume"]};Sai.StockChart.prototype.renderPlots=function(){var a,c,b,d,f,e,h,g,j,m;typeof(a=this.px)!=="undefined"&&a!==null||this.setPlotCoords();h=typeof(a=this.semanticRenames.open)!=="undefined"&&a!==null?a:"open";b=typeof(a=this.semanticRenames.close)!==
"undefined"&&a!==null?a:"close";d=typeof(a=this.semanticRenames.high)!=="undefined"&&a!==null?a:"high";e=typeof(a=this.semanticRenames.low)!=="undefined"&&a!==null?a:"low";m=typeof(a=this.semanticRenames.volume)!=="undefined"&&a!==null?a:"volume";this.colors=typeof this.colors!=="undefined"&&this.colors!==null?this.colors:{};this.colors.up=typeof this.colors.up!=="undefined"&&this.colors.up!==null?this.colors.up:"black";this.colors.down=typeof this.colors.down!=="undefined"&&this.colors.down!==null?
this.colors.down:"red";this.colors.vol_up=typeof this.colors.vol_up!=="undefined"&&this.colors.vol_up!==null?this.colors.vol_up:"#666666";this.colors.vol_down=typeof this.colors.vol_down!=="undefined"&&this.colors.vol_down!==null?this.colors.vol_down:"#cc6666";this.drawLogo();this.drawBG();if(!(typeof(a=this.ndata.prices)!=="undefined"&&a!==null&&h in this.ndata.prices&&b in this.ndata.prices&&d in this.ndata.prices&&e in this.ndata.prices)){this.showError("This chart requires data series named\nopen, close, high, and low.\n \nOnce you add series with these names, the chart will display.");
return null}this.ndata.prices.__YVALS__[0]<0&&this.drawGuideline(0,"prices");this.plots=this.r.set();j={up:[],down:[]};c={};a=this.ndata.prices;for(f in a)if(o.call(a,f))f.match("^__")||f===this.__LABELS__||(c[f]=this.data[f]);if(typeof(a=this.data[m])!=="undefined"&&a!==null)c.vol=this.data[m];if("volume"in this.ndata){a=this.ndata.volume[m].length;for(f=0;0<=a?f<a:f>a;0<=a?f+=1:f-=1)if(this.ndata.volume[m][f]!==null)if(f&&this.ndata.prices[b][f-1]&&this.ndata.prices[b][f][1]<this.ndata.prices[b][f-
1][1]){j.down.push(this.ndata.volume[m][f]);j.up.push([this.ndata.volume[m][f][0],0])}else{j.up.push(this.ndata.volume[m][f]);j.down.push([this.ndata.volume[m][f][0],0])}else{j.up.push([0,0]);j.down.push([0,0])}this.plots.push((new Sai.BarPlot(this.r,this.px,this.py,this.pw,this.ph*0.2,j,c)).render(true,this.normalizedHeight(0,m),{up:this.colors.vol_up,down:this.colors.vol_down}).set)}this.plots.push((new Sai.CandlestickPlot(this.r,this.px,this.py,this.pw,this.ph,{open:this.ndata.prices[h],close:this.ndata.prices[b],
high:this.ndata.prices[d],low:this.ndata.prices[e]},c)).render(this.colors,Math.min(5,this.pw/this.ndata.prices[h].length-2)).set);c={};a=this.ndata.prices;for(g in a)if(o.call(a,g))h===g||b===g||d===g||e===g||g.match("^__")||g===this.__LABELS__||(c[g]=this.ndata.prices[g]);return this.plots.push((new Sai.LinePlot(this.r,this.px,this.py,this.pw,this.ph,c)).render(this.colors).set)};Sai.StockChart.prototype.renderFull=function(){var a,c,b,d,f,e,h,g,j,m;this.drawTitle();this.setupInfoSpace();this.drawFootnote();
h=typeof(a=this.semanticRenames.open)!=="undefined"&&a!==null?a:"open";b=typeof(a=this.semanticRenames.close)!=="undefined"&&a!==null?a:"close";f=typeof(a=this.semanticRenames.high)!=="undefined"&&a!==null?a:"high";e=typeof(a=this.semanticRenames.low)!=="undefined"&&a!==null?a:"low";m=typeof(a=this.semanticRenames.volume)!=="undefined"&&a!==null?a:"volume";c={};j=false;a=this.ndata.prices;for(g in a)if(o.call(a,g))if(!(h===g||b===g||f===g||e===g)&&!(g.match("^__")||g===this.__LABELS__)){c[g]=(this.colors==
null?undefined:this.colors[g])||"black";j=true}j&&this.drawLegend(c);this.addAxes(["prices"]);this.renderPlots();d=this.pw/(this.data[this.__LABELS__].length-1);this.glow=this.r.rect(this.px-d/2,this.py-this.ph,d,this.ph).attr({fill:"0-"+this.opts.bgcolor+"-#DDAA99-"+this.opts.bgcolor,"stroke-width":0,"stroke-opacity":0}).toBack().hide();this.bg.toBack();this.r.set().push(this.bg,this.plots,this.logo,this.glow,this.guidelines).mousemove(p(function(k){var n,q,l,t,r;k=this.getIndex(k);l={};if(typeof(n=
this.data[this.__LABELS__][k])!=="undefined"&&n!==null)l[this.__LABELS__]=this.data[this.__LABELS__][k];t=false;n=this.ndata.prices;for(r in n)if(o.call(n,r))if(!(r.match("^__")||r===this.__LABELS__))if(typeof(q=this.data[r]==null?undefined:this.data[r][k])!=="undefined"&&q!==null){l[r]=this.data[r][k];t=true}if(typeof(n=this.data[m]==null?undefined:this.data[m][k])!=="undefined"&&n!==null){l[m]=this.data[m][k];t=true}this.drawInfo(l);return t?this.glow.attr({x:this.px+d*(k-0.5)}).show():null},this)).mouseout(p(function(){this.drawInfo({},
true);return this.glow.hide()},this));return this};Sai.GeoChart=function(){var a;a=this;this.renderPlots=function(){return Sai.GeoChart.prototype.renderPlots.apply(a,arguments)};return Sai.Chart.apply(this,arguments)};i(Sai.GeoChart,Sai.Chart);Sai.GeoChart.prototype.plotType=Sai.GeoPlot;Sai.GeoChart.prototype.interactiveHistogram=true;Sai.GeoChart.prototype.getMax=function(a){return Math.max.apply(Math,a)};Sai.GeoChart.prototype.getMin=function(a){return Math.min.apply(Math,a)};Sai.GeoChart.prototype.normalize=
function(a){var c,b,d,f,e,h,g,j,m,k,n,q,l;this.ndata={};this.bounds={};j={};k={};d=a;for(l in d)if(o.call(d,l))if(!(l.match("^__")||l===this.__LABELS__))if(typeof(f=a[l])!=="undefined"&&f!==null){h=[];f=a[l];c=0;for(b=f.length;c<b;c++){g=f[c];typeof g!=="undefined"&&g!==null&&h.push(g)}h=h;j[l]=this.getMax(h,l);if(!(typeof n!=="undefined"&&n!==null)||j[l]>n)n=j[l];k[l]=this.getMin(h,l);if(!(typeof q!=="undefined"&&q!==null)||k[l]<q)q=k[l]}h=[];d=a;for(l in d)if(o.call(d,l))if(!(l.match("^__")||l===
this.__LABELS__))if(typeof(f=a[l])!=="undefined"&&f!==null){if(this.opts.groupedNormalization){g=n;m=q}else{g=j[l];m=k[l]}this.bounds[l]=[m,g];this.ndata[l]={};var t=this.ndata[l],r=l;c=[];f=a[l].length;for(b=0;0<=f?b<f:b>f;0<=f?b+=1:b-=1)c.push(typeof(e=a[l][b])!=="undefined"&&e!==null?[b/(a[l].length-1),(a[l][b]-m)/(g-m)]:null);t[r]=c}return h};Sai.GeoChart.prototype.dataGroups=function(a){var c,b,d;b=[];c=a;for(d in c)if(o.call(c,d))if(d.match("^__")||d===this.__LABELS__)b.push(d);b={__META__:b};
c=a;for(d in c)if(o.call(c,d))d.match("^__")||d===this.__LABELS__||(b[d]=[d]);return b};Sai.GeoChart.prototype.setupHistogramInteraction=function(a,c){return a.click(p(function(){return this.renderPlots(c)},this)).hover(p(function(b){return p(function(){b.attr({"fill-opacity":0.75});return this.drawInfo({"Click to display on map":c})},this)},this)(a),p(function(b){return p(function(){b.attr({"fill-opacity":1});return this.drawInfo()},this)},this)(a))};Sai.GeoChart.prototype.renderPlots=function(a){var c,
b,d;typeof(c=this.px)!=="undefined"&&c!==null||this.setPlotCoords();this.bg==null||this.bg.remove();this.logo==null||this.logo.remove();this.geoPlot==null||this.geoPlot.set.remove();this.drawBG();this.drawLogo();b={};c=this.ndata;for(d in c)if(o.call(c,d))b[d]=this.ndata[d][d];this.geoPlot=(new this.plotType(this.r,this.px,this.py,this.pw,this.ph,b,this.data,{fromWhite:this.opts.fromWhite})).render(this.colors||{},this.data.__MAP__,this.__LABELS__,typeof a!=="undefined"&&a!==null?a:this.data.__DEFAULT__,
this.opts.bgcolor,this.opts.interactive&&!this.opts.simple,this.drawInfo);return this};Sai.GeoChart.prototype.default_info=function(){return{"":this.opts.interactive?"Click histogram below to change map display":""}};Sai.GeoChart.prototype.renderFull=function(){var a,c,b,d;this.drawTitle();this.setupInfoSpace();this.drawFootnote();this.drawHistogramLegend(function(){c=[];a=this.data;for(d in a)if(o.call(a,d))d.match("^__")||d===this.__LABELS__||c.push(d);return c}.call(this));this.setPlotCoords();
this.drawInfo();this.renderPlots();b=this.r.set().push(this.geoPlot.set,this.bg,this.logo,this.info,this.footnote);this.opts.href&&b.attr({href:this.opts.href,target:"_blank"});return this};Sai.ChromaticGeoChart=function(){return Sai.GeoChart.apply(this,arguments)};i(Sai.ChromaticGeoChart,Sai.GeoChart);Sai.ChromaticGeoChart.prototype.plotType=Sai.ChromaticGeoPlot;Sai.ChromaticGeoChart.prototype.interactiveHistogram=false;Sai.ChromaticGeoChart.prototype.default_info=function(){return{}};Sai.ChromaticGeoChart.prototype.setupHistogramInteraction=
function(){return false};Sai.ScatterChart=function(){return Sai.Chart.apply(this,arguments)};i(Sai.ScatterChart,Sai.Chart);Sai.ScatterChart.prototype.dataGroups=function(a){var c,b,d;b=[];c=a;for(d in c)if(o.call(c,d))if(d.match("^__")||d===this.__LABELS__)b.push(d);b={__META__:b};c=a;for(d in c)if(o.call(c,d))d.match("^__")||d===this.__LABELS__||(b[d]=[d]);return b};Sai.ScatterChart.prototype.renderPlots=function(){var a,c,b,d,f,e,h;typeof(a=this.px)!=="undefined"&&a!==null||this.setPlotCoords();
b=typeof(a=this.opts.colors)!=="undefined"&&a!==null?a:typeof(c=this.colors)!=="undefined"&&c!==null?c:["black","white"];h=typeof(a=this.opts.stroke_opacity)!=="undefined"&&a!==null?a:[0,1];e=typeof(a=this.opts.stroke_colors)!=="undefined"&&a!==null?a:["black","black"];d=typeof(a=this.opts.radius)!=="undefined"&&a!==null?a:[4,12];this.drawLogo();this.drawBG();c={};a=this.ndata;for(f in a)if(o.call(a,f))c[f]=this.ndata[f][f];this.plots=this.r.set();this.plots.push((new Sai.ScatterPlot(this.r,this.px,
this.py,this.pw,this.ph,c,this.data)).render(this.opts.mappings,b,d,h,e,this.opts.interactive&&!this.opts.simple,this.drawInfo).set);return this};Sai.ScatterChart.prototype.renderFull=function(){var a,c,b,d,f,e,h,g;this.drawTitle();this.setupInfoSpace();this.drawFootnote();d=typeof(a=this.opts.colors)!=="undefined"&&a!==null?a:typeof(c=this.colors)!=="undefined"&&c!==null?c:["black","white"];a=this.opts.stroke_opacity;g=typeof(a=this.opts.stroke_colors)!=="undefined"&&a!==null?a:["black","black"];
e=[];c={};if(d instanceof Array){e.push(this.opts.mappings.color);c[this.opts.mappings.color]={__LOW__:d[0],__HIGH__:d[1]}}else{h=typeof h!=="undefined"&&h!==null?h:{};f=true;a=d;for(b in a)if(o.call(a,b))h[b]=d[b]}if(g instanceof Array){e.push(this.opts.mappings.stroke_color);c[this.opts.mappings.stroke_color]={__LOW__:g[0],__HIGH__:g[1]}}else{h=typeof h!=="undefined"&&h!==null?h:{};f=true;a=d;for(b in a)if(o.call(a,b))h[b]=g[b]}e.length&&this.drawHistogramLegend(e,c);f&&this.drawLegend(d);this.__LABELS__=
"__XVALS__";this.data.__XVALS__=this.ndata[this.opts.mappings.x].__YVALS__;this.addAxes([this.opts.mappings.y],{left:this.opts.mappings.y,bottom:this.opts.mappings.x});this.renderPlots();a=this.r.set().push(this.plots,this.bg,this.logo,this.info,this.footnote,this.histogramLegend,this.legend);this.opts.href&&a.attr({href:this.opts.href,target:"_blank"});return this}}).call(this);
