Sai={};var _base,_base2,_ref,_ref2,_ref3,_ref4;Sai.util={};(_ref=Sai.imagePath)!=null||(Sai.imagePath="/static/images/sai/");Sai.util.roundToMag=function(d,a){var b;if(a==null)a=0;b=Math.pow(10,a);return parseFloat((Math.round(d/b)*b).toFixed(Math.max(0,a)))};Sai.util.round=function(d,a){return parseFloat((Math.round(d/a)*a).toFixed(Math.max(0,Math.ceil(-1*Math.log(a)/Math.LN10))))};
Sai.util.sumArray=function(d){var a,b,c;a=b=0;for(c=d.length;0<=c?a<c:a>c;0<=c?a+=1:a-=1)b+=typeof d[a]==="number"?d[a]:0;return b};
Sai.util.prettystr=function(d,a){var b,c;b=a!=null?a:1;a!=null||(a=2);if(typeof d==="number"){if(Math.abs(d)>=1E12){c="t";d/=1E12}else if(Math.abs(d)>=1E9){if(b>=8)return d;c="b";d/=1E9}else if(Math.abs(d)>=1E6){if(b>=5)return d;c="m";d/=1E6}else if(Math.abs(d)>=1E3){if(b>=2)return d;c="k";d/=1E3}else return String(parseFloat(d.toFixed(a)));return parseFloat(d.toFixed(b))+c}return d};
Sai.util.prettynum=function(d){var a;if(!(isNaN(parseFloat(d))||!String(d).match(/^[-+]?\d+(\.\d+)?$/))){d=String(d).split(".");for(a=/(\d+)(\d{3})/;a.test(d[0]);)d[0]=d[0].replace(a,"$1,$2");return d[0]+(d.length>1?parseFloat("0."+d[1]).toFixed(2).slice(1):"")}};Sai.util.infoSetters=function(d,a){return[function(){return d(a)},function(){return d()}]};
Sai.util.transformCoords=function(d,a){var b;if(a.getScreenCTM){b=a.createSVGPoint();b.x=d.clientX;b.y=d.clientY;b=b.matrixTransform(a.getScreenCTM().inverse());if(navigator.userAgent.toLowerCase().indexOf("chrome")!==-1||navigator.userAgent.toLowerCase().indexOf("safari")!==-1){b.x+=document.body.scrollLeft;b.y+=document.body.scrollTop}return{x:b.x,y:b.y}}else return{x:d.x,y:d.y}};
Sai.util.multiplyColor=function(d,a,b,c){if(c==null)c=0;a=c+(1-c)*a;c=Raphael.getRGB(d);if(b){d=c.r+(255-c.r)*(1-a);b=c.g+(255-c.g)*(1-a);a=c.b+(255-c.b)*(1-a)}else{d=c.r*a;b=c.g*a;a=c.b*a}return{r:d,g:b,b:a,str:"rgb("+d+", "+b+", "+a+")"}};Sai.util.colerp=function(d,a,b){d=Raphael.getRGB(d);a=Raphael.getRGB(a);return"rgb("+(a.r*b+d.r*(1-b))+", "+(a.g*b+d.g*(1-b))+", "+(a.b*b+d.b*(1-b))+")"};
Sai.util.reflectColor=function(d,a){var b,c,f,e,g,j,h,i,k;f=Raphael.getRGB(d);g=Raphael.getRGB(a);j={};k=["r","g","b"];h=0;for(i=k.length;h<i;h++){c=k[h];b=f[c];e=g[c];j[c]=b===e?b:b>e?e*((255-b)/(255-e)):(255*(e-b)+e*b)/e}return"rgb("+j.r+", "+j.g+", "+j.b+")"};(_ref2=Sai.data)!=null||(Sai.data={});(_ref3=(_base=Sai.data).map)!=null||(_base.map={});(_ref4=(_base2=Raphael.fn).sai)!=null||(_base2.sai={});
Raphael.fn.sai.chart=function(d,a,b,c,f,e){var g;f=(g={line:Sai.LineChart}[f])!=null?g:f;f!=null||(f=Sai.Chart);return(new f(this,d,a,b,c,e)).render()};var getHoverfuncs,__indexOf=Array.prototype.indexOf||function(d){for(var a=0,b=this.length;a<b;a++)if(this[a]===d)return a;return-1};(_ref=(_base=Raphael.fn.sai).prim)!=null||(_base.prim={});getHoverfuncs=function(d,a,b,c){return[function(){d.attr(a);return c!=null?typeof c[0]==="function"?c[0](d):void 0:void 0},function(){d.attr(b);return c!=null?typeof c[1]==="function"?c[1](d):void 0:void 0}]};
Raphael.fn.sai.prim.haxis=function(d,a,b,c,f){var e,g,j,h,i,k,l,n,o,m,p,q,r,s,v,u,x,z,y;q=(v=f.ticklens)!=null?v:[5,2];v=(j=f.width)!=null?j:1;j=(m=f.color)!=null?m:"black";n=this.path("M"+a+" "+b+"l"+c+" 0").attr("stroke",j);r=this.set();l=this.set();m=c/25;k=m<d.length?Math.ceil(d.length/m):1;h=c/(d.length-1)*k;x=a;u=-1;p=false;m=0;z=null;i=0;for(y=d.length;0<=y?i<y:i>y;i+=k){e=d[i];if(e!=null){g=q[String(e)?0:1];r.push(this.path("M"+x+" "+b+"l0 "+g).attr("stroke",j));if(e!==""){g=this.text(x,b+
g+2,Sai.util.prettystr(e).substring(0,12));e=g.getBBox();o=g.attr("y")+5;g.attr("y",o);if(z==null||o<z)z=o;l.push(g);g=e.width;m=Math.max(g,m);if(e.x<=u+3)p=true;if(e.x+g>u)u=e.x+g}}x+=h}if(f.title!=null)s=this.text(a+c/2,z+14,f.title).attr({"font-size":"12px","font-weight":"bold"});d=this.set().push(n,r,l,s);if(p){s=l.items;c=0;for(f=s.length;c<f;c++){g=s[c];g.rotate(-90);g.translate(0,g.getBBox().width/2-2)}d.push(this.rect(a,b,1,v+m+q[0]).attr("opacity","0"))}return d};
Raphael.fn.sai.prim.vaxis=function(d,a,b,c,f){var e,g,j,h,i,k,l,n,o,m,p,q,r,s,v,u,x;p=(e=f.ticklens)!=null?e:[5,2];e=(n=f.color)!=null?n:"black";m=(k=f.right)!=null?k:false;n=this.path("M"+a+" "+b+"l0 "+-c).attr("stroke",e);q=this.set();k=this.set();j=c/(d.length-1);v=b;s=null;i=[];l=true;u=0;for(x=d.length;u<x;u++){h=d[u];if(h!==null){h=Sai.util.prettystr(h);if(__indexOf.call(i,h)>=0){l=false;break}i.push(h)}}if(!l){u=[];i=0;for(l=d.length;i<l;i++){h=d[i];u.push(Sai.util.prettystr(h,2))}i=u}u=l=
0;for(x=d.length;u<x;u++){h=d[u];if(h!==null){h=p[String(h)?0:1];q.push(this.path("M"+a+" "+v+"l"+(m?h:-h)+" 0").attr("stroke",e));o=a+(m?1:-1)*(h+3);h=this.text(o,v,i[l++]);h.attr({"text-anchor":m?"start":"end",fill:e});o+=(m?1:-1)*(h.getBBox().width+8);if(s==null||o<s)s=o;k.push(h)}v-=j}if(f.title!=null){r=this.text(s,b-c/2,f.title).attr({"font-size":"12px","font-weight":"bold"});d=r.getBBox();r.rotate(-90);g=this.rect(d.x+(d.width-d.height)/2,b,d.height,1).attr({opacity:0})}g!=null||(g=null);return this.set().push(this.set().push(n,
q,k,g),r)};
Raphael.fn.sai.prim.popup=function(d,a,b){var c,f,e,g,j,h;this.set();h=this.set();f=0;e=a+5+5;if("__HEAD__"in b){c=this.text(d,e,b.__HEAD__).attr({fill:"#cfc","font-size":"12","font-weight":"bold"});f=Math.max(f,c.getBBox().width);h.push(c);e+=17}for(j in b)if(j!=="__HEAD__"){g=this.text(d+5,e,j+" = "+b[j]).attr({fill:"white","font-weight":"bold","text-anchor":"start"});f=Math.max(f,g.getBBox().width);e+=10;h.push(g)}b=f+10;this.rect(d,a,b,e-a,5).attr({fill:"black","fill-opacity":".85",stroke:"black"});
c!=null&&c.translate(b/2);return h.toFront()};Raphael.fn.sai.prim.legend=function(d,a,b,c,f){var e,g,j,h,i,k,l,n,o;a-=14;i=this.set();j=d;h=a;for(k in c){g=this.text(j+14,h+5,k).attr({fill:(l=f!=null?f[k]:void 0)!=null?l:"black","text-anchor":"start"});e=this.rect(j,h,9,9).attr({fill:(n=c[k])!=null?n:"black",stroke:(o=f!=null?f[k]:void 0)!=null?o:"black"});e=this.set().push(g,e);g=e.getBBox().width;if(j-d+15+g>b){i.translate(0,-14);e.translate(d-j,a-h);j=d;h=a}j+=g+15;i.push(e)}return i};
Raphael.fn.sai.prim.wrappedText=function(d,a,b,c,f){var e,g,j,h;if(c==null)c="";if(f==null)f=" ";typeof spacing!="undefined"&&spacing!==null||(spacing=1);if(!c.match(/^\s*$/)){b=b/6;j=[];for(g=0;g<c.length-1;){e=g+b;h=c.substring(g,e+1);e=e>=c.length?e:h.lastIndexOf(f);j.push(h.substring(0,e));g+=e+1}c=j.join("\n");return this.text(d,a+5*j.length,c).attr({"font-family":"Lucida Console","text-anchor":"start"})}};
Raphael.fn.sai.prim.info=function(d,a,b,c){var f,e,g,j,h,i;g=this.set();e=d;a=a;for(f in c)if(c[f]!==null){j=f+(f===""?"":": ");j+=typeof c[f]==="string"?c[f]:(i=Sai.util.prettynum(c[f]))!=null?i:Sai.util.prettystr(c[f]);h=6*j.length;if(e-d+h>b){e=d;a+=14}j=this.text(e,a,j).attr({"font-family":"Lucida Console","text-anchor":"start"});e+=h+15;g.push(j)}return g};
Raphael.fn.sai.prim.hoverShape=function(d,a,b,c){d=d(this).attr(a);b=getHoverfuncs(d,c&&c[0]||{},c&&c[1]||{},b);d.mouseover(b[0]);d.mouseout(b[1]);return d};
Raphael.fn.sai.prim.histogram=function(d,a,b,c,f,e,g,j,h,i,k,l){var n,o,m,p,q,r;if(e==null)e=0;if(g==null)g=1;if(h==null)h=["black","white"];if(i==null)i="white";if(l==null)l=10;q=this.set();q.push(this.rect(d,a-c,b,c).attr({"stroke-width":0,"stroke-opacity":0,fill:i}));c=a-(c-12);a-=5;q.push(this.text(d,a,Sai.util.prettystr(e)).attr({"text-anchor":"start"}));q.push(this.text(d+b,a,Sai.util.prettystr(g)).attr({"text-anchor":"end"}));a-=7;e={};i=g=0;for(r=f.length;i<r;i++){m=f[i];m=Math.min(l-1,Math.floor(l*
m/1));if(m in e)e[m]+=1;else e[m]=1;g=Math.max(g,e[m])}q.push(this.rect(d,a,b,1).attr({fill:"0-"+h[0]+"-"+((o=h[1])!=null?o:h[0]),"stroke-width":0,"stroke-opacity":0}));a-=1;o=b/l;for(n in e){f=(a-c)*(e[n]/g);q.push(h.length===1?p=Sai.util.multiplyColor(h[0],(parseInt(n)+0.5)/l,k,0.2).str:p=Sai.util.colerp(h[0],h[1],(parseInt(n)+0.5)/l),this.rect(d+(parseInt(n)+0.2)*o,a-f,o*0.6,f).attr({fill:p,"stroke-width":k?0.35:0,"stroke-opacity":k?1:0,stroke:"#000000"}))}q.push(this.text(d+b/2,c-6,Sai.util.prettystr(j)));
return q};Raphael.fn.sai.prim.candlestick=function(d,a,b,c,f,e,g,j,h,i,k){if(g==null)g="black";e%2||e++;e=this.rect(d-e/2,a,e,b-a||1).attr("stroke",g);c=this.path("M"+d+" "+c+"L"+d+" "+a+"M"+d+" "+b+"L"+d+" "+f).attr("stroke",g);e.attr("fill",j?g:"#ffffff");g=this.set().push(e,c);if(h){d=getHoverfuncs(g,{scale:"1.5,1.5,"+d+","+(a+(b-a)/2),"fill-opacity":0.5},{scale:"1.0,1.0,"+d+","+(a+(b-a)/2),"fill-opacity":1},k);g.hover(d[0],d[1])}return g};Raphael.fn.sai.prim.line=function(d,a,b){var c,f,e,g;if(a==null)a="black";if(b==null)b=1;e=0;for(g=d.length;e<g;e++){c=d[e];if(c!=null)if(typeof f!="undefined"&&f!==null)f+="L"+c[0]+" "+c[1];else f="M"+c[0]+" "+c[1]}return this.path(f).attr({stroke:a,"stroke-width":b})};
Raphael.fn.sai.prim.area=function(d,a,b,c){var f,e,g,j,h;if(a==null)a="black";if(b==null)b=1;if(d.length<2)return this.set();j=0;for(h=d.length;j<h;j++){e=d[j];if(e!=null)if(typeof g!="undefined"&&g!==null){g+="L"+e[0]+" "+e[1];f+="L"+e[0]+" "+e[1]}else{g="M"+e[0]+" "+e[1];f="M"+e[0]+" "+e[1]}}for(d=h=c.length-1;h<=0?d<=0:d>=0;d+=-1){e=c[d][0];j=c[d][1];f+="L"+e+","+j}c=this.path(f).attr({fill:a,"stroke-width":0,"stroke-opacity":0,"fill-opacity":0.35});a=this.path(g).attr({stroke:a,"stroke-width":b});
return this.set().push(c,a)};Raphael.fn.sai.prim.stackedBar=function(d,a,b,c,f,e,g){var j,h,i,k,l,n,o,m,p,q;if(f){k=l=c;n=0;for(m=d.length;n<m;n++){h=d[n];if(k<h[1])k=h[1];if(l>h[1])l=h[1]}p=k-l||1}b*=0.67;m=this.set();n=[c,c];l=function(r){return r<c?1:0};h=0;for(q=d.length;0<=q?h<q:h>q;0<=q?h+=1:h-=1)if(d[h]!=null&&d[h][1]!==c){k=l(d[h][1]);i=Math.abs(n[k]-d[h][1]);j=n[k]===c?1:0;o=d[h][1]-(k?0:i-j);m.push(j=this.rect(d[h][0]-b/2,o,b,i-j).attr("fill",(a!=null?a[h]:void 0)||"#000000").attr("stroke",(a!=null?a[h]:void 0)||"#000000"));
if(f){i=getHoverfuncs(j,{"fill-opacity":"0.75"},{"fill-opacity":"1.0"},[function(r){return function(){g[0]&&g[0]();return e({"(selected)":Sai.util.prettystr(r)+"%"},false)}}(100*(i/p)),g[1]]);j.hover(i[0],i[1])}n[k]=d[h][1]}return m};
Raphael.fn.sai.prim.groupedBar=function(d,a,b,c,f,e,g){var j,h,i,k,l,n;e=this.set();j=b/(d.length+1);k=(b-j)/2;i=0;for(l=d.length;0<=l?i<l:i>l;0<=l?i+=1:i-=1)if(((n=d[i])!=null?n[0]:void 0)!=null){b=Math.min(d[i][1],c);h=Math.max(d[i][1],c)-b-0.5;e.push(this.rect(d[i][0]-k+i*j,b,j-1,h).attr("fill",(a!=null?a[i]:void 0)||"#000000").attr("stroke",(a!=null?a[i]:void 0)||"#000000"))}if(f){d=getHoverfuncs(e,{"fill-opacity":"0.75"},{"fill-opacity":"1.0"},g);e.hover(d[0],d[1])}return e};Sai.Plot=function(){function d(a,b,c,f,e,g,j,h){this.r=a;this.x=b;this.y=c;this.w=f;this.h=e;this.data=g;this.rawdata=j;this.opts=h!=null?h:{};this.setDenormalizedData();this.set=this.r.set()}d.prototype.setDenormalizedData=function(){var a,b,c,f,e,g,j,h,i,k;if(this.data instanceof Array){j=this.data;i=[];c=0;for(e=j.length;c<e;c++){a=j[c];i.push(this.denormalize(a))}return this.dndata=i}else{this.dndata!=null||(this.dndata={});c=[];for(b in this.data)c.push(this.dndata[b]=function(){h=this.data[b];
k=[];f=0;for(g=h.length;f<g;f++){a=h[f];k.push(this.denormalize(a))}return k}.call(this));return c}};d.prototype.denormalize=function(a){if(a instanceof Array)return[this.x+this.w*a[0],this.y-this.h*a[1]]};d.prototype.render=function(){this.set.push(this.r.rect(20,20,20,20).attr("fill","red"),this.r.circle(40,40,10).attr("fill","blue"));return this};return d}();var __hasProp=Object.prototype.hasOwnProperty,__extends=function(d,a){function b(){this.constructor=d}for(var c in a)if(__hasProp.call(a,c))d[c]=a[c];b.prototype=a.prototype;d.prototype=new b;d.__super__=a.prototype;return d};
Sai.CandlestickPlot=function(){function d(){d.__super__.constructor.apply(this,arguments)}__extends(d,Sai.Plot);d.prototype.render=function(a,b,c,f){var e,g,j,h,i,k;if(b==null)b=5;this.set.remove();e=(a!=null?a.up:void 0)||"black";a=(a!=null?a.down:void 0)||"red";g=0;for(k=this.dndata.open.length;0<=k?g<k:g>k;0<=k?g+=1:g-=1)if(this.dndata.close[g]!=null){i=this.dndata.close[g][1]<this.dndata.open[g][1];j={};for(h in this.rawdata)j[h]=this.rawdata[h][g];this.set.push(this.r.sai.prim.candlestick(this.dndata.open[g][0],
i&&this.dndata.close[g][1]||this.dndata.open[g][1],i&&this.dndata.open[g][1]||this.dndata.close[g][1],this.dndata.high[g][1],this.dndata.low[g][1],b||5,g&&this.dndata.close[g-1]!=null&&this.dndata.close[g-1][1]<this.dndata.close[g][1]?a:e,!i,c,f,Sai.util.infoSetters(f,j)))}return this};return d}();__hasProp=Object.prototype.hasOwnProperty;__extends=function(d,a){function b(){this.constructor=d}for(var c in a)if(__hasProp.call(a,c))d[c]=a[c];b.prototype=a.prototype;d.prototype=new b;d.__super__=a.prototype;return d};var __bind=function(d,a){return function(){return d.apply(a,arguments)}};
Sai.ScatterPlot=function(){function d(){d.__super__.constructor.apply(this,arguments)}__extends(d,Sai.Plot);d.prototype.render=function(a,b,c,f,e,g,j){var h,i,k,l,n,o,m,p,q,r,s,v,u,x,z,y,C,D,B,E,M,G,H,I,J,K,L,N,O;this.set.remove();for(q in this.dndata){m=this.dndata[q].length;break}o=function(t,w,A){return w*A+t*(1-A)};x=__bind(function(t){return this.x+this.w*((t-this.y)/-this.h)},this);z=function(t){v=x((y=this.dndata[a.x])!=null?y[t][1]:void 0);u=(G=this.dndata[a.y])!=null?G[t][1]:void 0;i=b instanceof
Array&&a.color!=null?Sai.util.colerp(b[0],b[1],(H=(I=this.data[a.color])!=null?(J=I[t])!=null?J[1]:void 0:void 0)!=null?H:0):b instanceof Object&&a.color!=null?b[this.rawdata[a.color][t]]:"black";r=e instanceof Array&&a.stroke_color!=null?Sai.util.colerp(e[0],e[1],(K=(L=this.data[a.stroke_color])!=null?(N=L[t])!=null?N[1]:void 0:void 0)!=null?K:0):b instanceof Object&&a.color!=null?e[this.rawdata[a.stroke_color][t]]:"black";p=c instanceof Array&&a.radius!=null?o(c[0],c[1],(O=(C=this.data[a.radius])!=
null?(D=C[t])!=null?D[1]:void 0:void 0)!=null?O:0):c instanceof Object&&a.radius!=null?c[this.rawdata[a.radius][t]]:5;s=f instanceof Array&&a.stroke_opacity!=null?o(f[0],f[1],(B=(E=this.data[a.stroke_opacity])!=null?(M=E[t])!=null?M[1]:void 0:void 0)!=null?B:0):f instanceof Object&&a.stroke_opacity!=null?f[this.rawdata[a.stroke_opacity][t]]:1;if(g){l={};for(q in this.rawdata)q.match("^__")||(l[q]=this.rawdata[q][t]);n=Sai.util.infoSetters(j,l)}return this.set.push(h=this.r.circle(v,u,p).attr({fill:i,
"stroke-opacity":s,stroke:r,"fill-opacity":0.8,"stroke-width":2}),g?h.hover(function(w){return function(){w();return this.attr("fill-opacity",0.5)}}(n[0]),function(w){return function(){w();return this.attr("fill-opacity",0.8)}}(n[1])):void 0)};for(k=0;0<=m?k<m:k>m;0<=m?k+=1:k-=1)z.call(this,k);return this};return d}();__hasProp=Object.prototype.hasOwnProperty;__extends=function(d,a){function b(){this.constructor=d}for(var c in a)if(__hasProp.call(a,c))d[c]=a[c];b.prototype=a.prototype;d.prototype=new b;d.__super__=a.prototype;return d};
Sai.LinePlot=function(){function d(){d.__super__.constructor.apply(this,arguments)}__extends(d,Sai.Plot);d.prototype.setDenormalizedData=function(){var a,b,c,f;d.__super__.setDenormalizedData.apply(this,arguments);f=[];for(a in this.dndata)f.push(this.dndata[a].length===1&&((b=this.dndata[a])!=null?(c=b[0])!=null?c[0]:void 0:void 0)===this.x?this.dndata[a].push([this.x+this.w,this.dndata[a][0][1]]):void 0);return f};d.prototype.render=function(a,b){var c;this.set.remove();for(c in this.dndata)c.match("^__")||
this.set.push(this.r.sai.prim.line(this.dndata[c],(a!=null?a[c]:void 0)||"black",b||1));return this};return d}();
Sai.AreaPlot=function(){function d(){d.__super__.constructor.apply(this,arguments)}__extends(d,Sai.LinePlot);d.prototype.render=function(a,b,c,f){var e,g,j,h,i,k,l;this.set.remove();l=[];i=0;for(k=f.length;i<k;i++){g=f[i];l.push(this.denormalize(g))}f=l;for(h in this.dndata)if(!h.match("^__")){g=0;for(i=this.dndata[h].length;0<=i?g<i:g>i;0<=i?g+=1:g-=1){e=this.dndata[h][g];if(e!=null)break}for(g=i=this.dndata[h].length-1;i<=0?g<=0:g>=0;i<=0?g+=1:g-=1){j=this.dndata[h][g];if(j!=null)break}l=[];i=0;
for(k=f.length;i<k;i++){g=f[i];l.push([Math.max(Math.min(j[0],g[0]),e[0]),g[1]])}g=l;this.set.push(this.r.sai.prim.area(this.dndata[h],(a!=null?a[h]:void 0)||"black",b||1,g));if(c)f=this.dndata[h]}return this};return d}();__hasProp=Object.prototype.hasOwnProperty;__extends=function(d,a){function b(){this.constructor=d}for(var c in a)if(__hasProp.call(a,c))d[c]=a[c];b.prototype=a.prototype;d.prototype=new b;d.__super__=a.prototype;return d};
Sai.GeoPlot=function(){function d(){d.__super__.constructor.apply(this,arguments)}__extends(d,Sai.Plot);d.prototype.getRegionColor=function(a,b,c){var f;return Sai.util.multiplyColor(a[c],((f=this.data[c][b])!=null?f[1]:void 0)||0,this.opts.fromWhite,this.opts.fromWhite?0.2:0).str};d.prototype.getRegionOpacity=function(a,b){var c;return((c=this.data[b][a])!=null?c[1]:void 0)!=null?1:this.opts.fromWhite?0.15:0.25};d.prototype.render=function(a,b,c,f,e,g,j){var h,i,k,l,n,o,m,p,q,r,s,v,u;this.set.remove();
u=this.rawdata[c];s=[];k=0;for(v=u.length;k<v;k++){h=u[k];s.push(h.toUpperCase())}p={};k=0;for(v=s.length;0<=v?k<v:k>v;0<=v?k+=1:k-=1)p[s[k]]=k;s=function(x){q=p[x];o=b.name[x];l={region:o!=null?o:x};for(r in this.rawdata)if(r!==c)l[r]=this.rawdata[r][q];i=this.getRegionColor(a,q,f);m=this.getRegionOpacity(q,f);n=Sai.util.infoSetters(j,l);return this.set.push(this.r.sai.prim.hoverShape(function(z,y,C,D){return function(B){return B.path(z).translate(C,D).scale(y,y,C,D)}}(b.paths[x],Math.min(this.w/
b.width,this.h/b.height),this.x,this.y-this.h),{fill:i,stroke:this.opts.fromWhite?"black":e,"stroke-width":0.5,opacity:m},g?[function(z){return function(y){navigator.userAgent.toLowerCase().indexOf("msie")!==-1||navigator.userAgent.toLowerCase().indexOf("opera")!==-1||y.toFront();return z()}}(n[0]),n[1]]:null,g?[{"fill-opacity":0.75,"stroke-width":this.opts.fromWhite?1.5:0.5},{"fill-opacity":1,"stroke-width":0.5}]:null))};for(h in b.paths)s.call(this,h);h=this.set.getBBox();this.set.translate((this.w-
h.width)/2,(this.h-h.height)/2);return this};return d}();
Sai.ChromaticGeoPlot=function(){function d(){d.__super__.constructor.apply(this,arguments)}__extends(d,Sai.GeoPlot);d.prototype.getRegionColor=function(a,b){var c,f,e,g,j,h;e=f=c=0;for(j in this.data){g=Sai.util.multiplyColor(a[j],((h=this.data[j][b])!=null?h[1]:void 0)||0,this.opts.fromWhite);e+=g.r;f+=g.g;c+=g.b}return"rgb("+e+", "+f+", "+c+")"};d.prototype.getRegionOpacity=function(a){var b,c;for(b in this.data)if(((c=this.data[b][a])!=null?c[1]:void 0)!=null)return 1;return 0.25};return d}();__hasProp=Object.prototype.hasOwnProperty;__extends=function(d,a){function b(){this.constructor=d}for(var c in a)if(__hasProp.call(a,c))d[c]=a[c];b.prototype=a.prototype;d.prototype=new b;d.__super__=a.prototype;return d};
Sai.BarPlot=function(){function d(){d.__super__.constructor.apply(this,arguments)}__extends(d,Sai.Plot);d.prototype.render=function(a,b,c,f,e,g){var j,h,i,k,l,n,o,m,p;this.set.remove();b=this.denormalize([0,b])[1];l=0;h=[];j=a?this.r.sai.prim.stackedBar:this.r.sai.prim.groupedBar;for(p in this.dndata){l=Math.max(l,this.dndata[p].length);h.push((c!=null?c[p]:void 0)||"black")}for(i=0;0<=l?i<l:i>l;0<=l?i+=1:i-=1){c=[];for(p in this.dndata)c.push(this.dndata[p][i]);k={};for(m in this.rawdata)k[m]=this.rawdata[m][i];
if(a){o=n=0;for(p in this.rawdata)if(p!==g)if(!isNaN(this.rawdata[p][i])){n+=Math.abs(this.rawdata[p][i]);o+=this.rawdata[p][i]}k["(magnitude)"]=n}this.set.push(j(c,h,this.w/l,b,f,e,Sai.util.infoSetters(e,k)))}return this};return d}();__bind=function(d,a){return function(){return d.apply(a,arguments)}};__indexOf=Array.prototype.indexOf||function(d){for(var a=0,b=this.length;a<b;a++)if(this[a]===d)return a;return-1};
Sai.Chart=function(){function d(a,b,c,f,e,g,j,h){var i;this.r=a;this.x=b;this.y=c;this.w=f;this.h=e;this.__LABELS__=j;this.opts=h!=null?h:{};this.drawInfo=__bind(this.drawInfo,this);(i=this.opts).bgcolor!=null||(i.bgcolor="white");this.setData(g);a=this.opts.simple?0:5;this.padding={left:a,right:a,top:a,bottom:a}}d.prototype.groupsToNullPad=function(){return[]};d.prototype.nonNegativeGroups=function(){return[]};d.prototype.nextSeriesSuffix=function(){var a;this.suffixCtr=((a=this.suffixCtr)!=null?
a:0)+1;return"["+this.suffixCtr+"]"};d.prototype.fixSeriesName=function(a){return a+(a.match(/^\s+$/)?this.nextSeriesSuffix():"")};d.prototype.setSemanticRename=function(a){var b,c;if(this.semanticRenamePatterns!=null){this.semanticRenames!=null||(this.semanticRenames={});c=[];for(b in this.semanticRenamePatterns)c.push(a.match(this.semanticRenamePatterns[b])?this.semanticRenames[b]=a:void 0);return c}};d.prototype.getBaseline=function(a){a=this.normalizedHeight(0,a!=null?a:"all");return[[0,a],[1,
a]]};d.prototype.setData=function(a){var b,c,f,e,g,j,h,i,k;this.data={};this.renames={};if(function(o){var m;for(m in o)if(o.hasOwnProperty(m))return false;return true}(a))this.render=function(){return this.showError("(no data -> empty chart)")};else{for(e in a){for(;;){g=this.fixSeriesName(e);this.setSemanticRename(g);if(g===e||!(g in a))break}this.renames[e]=g;if(a[e]instanceof Array)if(this.__LABELS__===e){this.__LABELS__=g;var l=this.data,n=g;i=a[e];k=[];j=0;for(h=i.length;j<h;j++){b=i[j];k.push(String(b))}l[n]=
k}else{l=this.data;n=g;i=a[e];k=[];j=0;for(h=i.length;j<h;j++){b=i[j];k.push(typeof b==="string"&&b.match(/^( +)?[+-]?[\d,]+(\.\d+)?( +)?$/)&&!isNaN(f=parseFloat(b.replace(/,/g,"")))?f:b)}l[n]=k}else this.data[g]=a[e]}a=this.dataGroups(this.data);f=this.nonNegativeGroups();for(c in a)if(a[c].length>0)if(__indexOf.call(f,c)>=0){h=a[c];g=0;for(j=h.length;g<j;g++){e=h[g];if(this.data[e]!=null){b=0;for(i=this.data[e].length;0<=i?b<i:b>i;0<=i?b+=1:b-=1)if(this.data[e][b]<0)this.data[e][b]*=-1}}}g=this.groupsToNullPad();
b=0;for(f=g.length;b<f;b++){c=g[b];if(c in a){h=a[c];j=0;for(c=h.length;j<c;j++){e=h[j];this.nullPad(e)}}}return this.normalize(this.data)}};d.prototype.nullPad=function(a){if(a in this.data)return this.data[a]=[null].concat(this.data[a].concat([null]))};d.prototype.caresAbout=function(a){return!(a.match("^__")||a===this.__LABELS__)};d.prototype.dataGroups=function(a){var b,c,f;c=[];for(b in a)this.caresAbout(b)&&c.push(b);f=[];for(b in a)if(b.match("^__")||b===this.__LABELS__)f.push(b);return{all:c,
__META__:f}};d.prototype.getYAxisVals=function(a,b,c){var f,e,g;if(c==null)c=false;if(!(typeof a==="number"&&typeof b==="number"))return[a,b];if(a===b)return[0,b,b*2];for(e=1;(b-a)*e<10;)e*=10;a*=e;b*=e;g=Math.floor(f=Math.log(b-a)/Math.LN10-0.4);g=Math.pow(10,g);if(f%1>0.7&&!c)g*=4;else if(f%1>0.35&&!c)g*=2;f=Sai.util.round(a-(c?g/2.1:g/1.75),g);if(f<0&&0<=a)f=0;a=Sai.util.round(b+(c?g/2.1:g/1.75),g);f/=e;a/=e;g/=e;e=f;for(b=[e];e<a;){e=Sai.util.round(e+g,g);b.push(e)}return b};d.prototype.getMax=
function(a,b){var c,f,e,g,j,h,i,k,l;return Math.max.apply(Math,function(){k=[];e=0;for(j=b.length;e<j;e++){f=b[e];a[f]!=null&&k.push(Math.max.apply(Math,function(){i=a[f];l=[];g=0;for(h=i.length;g<h;g++){c=i[g];c!=null&&typeof c==="number"&&l.push(c)}return l}()))}return k}())};d.prototype.getMin=function(a,b){var c,f,e,g,j,h,i,k,l;return Math.min.apply(Math,function(){k=[];e=0;for(j=b.length;e<j;e++){f=b[e];a[f]!=null&&k.push(Math.min.apply(Math,function(){i=a[f];l=[];g=0;for(h=i.length;g<h;g++){c=
i[g];c!=null&&typeof c==="number"&&l.push(c)}return l}()))}return k}())};d.prototype.getStackedMax=function(a,b){var c,f,e,g,j,h,i,k;this.stackedMax!=null||(this.stackedMax={});this.stackedMax[b]=(j=this.stackedMax[b])!=null?j:Math.max.apply(Math,function(){i=[];c=0;for(h=a[this.__LABELS__].length;0<=h?c<h:c>h;0<=h?c+=1:c-=1)i.push(Sai.util.sumArray(function(){k=[];e=0;for(g=b.length;e<g;e++){f=b[e];f!==this.__LABELS__&&a[f][c]>=0&&k.push(a[f][c])}return k}.call(this)));return i}.call(this));return this.stackedMax[b]};
d.prototype.getStackedMin=function(a,b){var c,f,e,g,j,h,i,k;this.stackedMin!=null||(this.stackedMin={});this.stackedMin[b]=(j=this.stackedMin[b])!=null?j:Math.min.apply(Math,function(){i=[];c=0;for(h=a[this.__LABELS__].length;0<=h?c<h:c>h;0<=h?c+=1:c-=1)i.push(Sai.util.sumArray(function(){k=[];e=0;for(g=b.length;e<g;e++){f=b[e];f!==this.__LABELS__&&a[f][c]<0&&k.push(a[f][c])}return k}.call(this)));return i}.call(this));return this.stackedMin[b]};d.prototype.normalize=function(a){var b,c,f,e,g,j,h,
i,k,l,n,o,m,p,q,r,s,v,u,x,z,y,C,D,B,E,M,G,H,I,J,K,L;h=this.dataGroups(a);this.ndata={};if(this.opts.stacked!=null)this.stackedNdata={};m=function(t,w,A){if(typeof t==="number")return w===A?1:(t-w)/(A-w);return null};b=function(t,w){var A,F,P;F=0;for(P=w.length;F<P;F++){A=w[F];if(!t(A))return false}return true};g=function(t){var w,A,F;A=0;for(F=t.length;A<F;A++){w=t[A];if(typeof w==="number")return false}return true};G=[];for(j in h){if(!(l=j.match("^__"))){if(!(l=Sai.util.sumArray(function(){y=h[j];
H=[];v=0;for(x=y.length;v<x;v++){r=y[v];H.push(this.data[r].length)}return H}.call(this))===0)){var N=b,O=g;C=h[j];I=[];l=0;for(o=C.length;l<o;l++){r=C[l];I.push(this.data[r])}l=N(O,I)}l=l}if(!l){this.ndata[j]={};if(this.opts.stacked!=null){this.stackedNdata[j]={};f={}}o=this.opts.stacked?__bind(function(t,w){return this.getStackedMin(t,w)},this):this.getMin;l=this.opts.stacked?__bind(function(t,w){return this.getStackedMax(t,w)},this):this.getMax;n=o(a,h[j]);k=l(a,h[j]);l=this.getYAxisVals(n,k);
n=l[0];k=l[l.length-1];this.ndata[j].__YVALS__=l;G.push(function(){D=h[j];J=[];u=0;for(z=D.length;u<z;u++){r=D[u];if(a[r]!=null){var t=this.ndata[j],w=r;K=[];i=0;for(B=a[r].length;0<=B?i<B:i>B;0<=B?i+=1:i-=1)K.push(a[r][i]!=null&&(q=m(a[r][i],n,k))!==null?[i/(a[r].length-1||1),q]:null);t[w]=K;J.push(function(){if(this.opts.stacked!=null){p=m(0,n,k);this.stackedNdata[j][r]=[];L=[];i=0;for(E=a[r].length;0<=E?i<E:i>E;0<=E?i+=1:i-=1){e=a[r][i]!=null&&a[r][i]<0?0:1;f[i]!=null||(f[i]=[p,p]);c=f[i][e];s=
[i/(a[r].length-1||1),((M=m(a[r][i],n,k))!=null?M:p)-p+c];this.stackedNdata[j][r].push(s);L.push(s!==null?f[i][e]=s[1]:void 0)}return L}}.call(this))}}return J}.call(this))}}return G};d.prototype.addAxes=function(a,b){var c,f,e,g,j,h,i,k,l,n,o,m,p;this.axisWidth=1.5;this.padding.top+=5;for(f=c=this.data[this.__LABELS__].length-1;c<=0?f<=0:f>=0;c<=0?f+=1:f-=1)if(this.data[this.__LABELS__][f]!=null){f=this.r.text(0,0,Sai.util.prettystr(this.data[this.__LABELS__][f]));this.padding.right+=f.getBBox().width/
2;f.remove();break}h=this.h-(this.padding.bottom+this.padding.top);c=this.ndata[a[0]]!=null||this.ndata[a[1]]==null;f=this.ndata[a[1]]!=null;if(c){p=this.r.sai.prim.vaxis((g=(k=this.ndata[a[0]])!=null?k.__YVALS__:void 0)!=null?g:[0,"?"],this.x+this.padding.left,this.y-this.padding.bottom,h,{width:this.axisWidth,title:b!=null?b.left:void 0});g=p.items[0].getBBox().width;p.remove()}else g=0;if(f){p=this.r.sai.prim.vaxis((e=(l=this.ndata[a[1]])!=null?l.__YVALS__:void 0)!=null?e:[0,"?"],this.x+this.padding.left,
this.y-this.padding.bottom,h,{width:this.axisWidth,title:b!=null?b.right:void 0});e=p.getBBox().width;p.remove()}else e=0;this.haxis=this.r.sai.prim.haxis(this.data[this.__LABELS__],this.x+this.padding.left+g,this.y-this.padding.bottom,this.w-this.padding.left-this.padding.right-g-e,{width:this.axisWidth,title:b!=null?b.bottom:void 0});e=this.haxis.getBBox().height;if(isNaN(e))e=1;this.haxis.translate(0,-e);this.padding.bottom+=e;h=this.h-(this.padding.bottom+this.padding.top);if(c){this.vaxis=this.r.sai.prim.vaxis((j=
(n=this.ndata[a[0]])!=null?n.__YVALS__:void 0)!=null?j:[0,"?"],this.x+this.padding.left,this.y-this.padding.bottom,h,{width:this.axisWidth,title:b!=null?b.left:void 0});j=this.vaxis.items[0].getBBox().width;this.vaxis.translate(j,0);this.padding.left+=j}if(f){this.vaxis_right=this.r.sai.prim.vaxis((o=(m=this.ndata[a[1]])!=null?m.__YVALS__:void 0)!=null?o:[0,"?"],this.w-this.padding.right,this.y-this.padding.bottom,h,{width:this.axisWidth,right:true,title:b!=null?b.right:void 0,color:this.ndata[a[0]]!=
null?(i=this.colors.__RIGHTAXIS__)!=null?i:"blue":"black"});i=this.vaxis_right.items[0].getBBox().width;this.vaxis_right.translate(-i,0);this.padding.right+=i}this.setPlotCoords();return this.r.set().push(this.haxis).push(this.vaxis)};d.prototype.setPlotCoords=function(){var a,b,c,f;this.px=this.x+this.padding.left;this.py=this.y-this.padding.bottom;this.pw=this.w-this.padding.left-this.padding.right;this.ph=this.h-this.padding.bottom-this.padding.top;a=(b=this.legend)!=null?b.getBBox():void 0;if((b=
this.legend)!=null)b.translate(this.px+this.pw/2-(a.x+a.width/2),0);a=(c=this.histogramLegend)!=null?c.getBBox():void 0;return(f=this.histogramLegend)!=null?f.translate(this.px+this.pw/2-(a.x+a.width/2),0):void 0};d.prototype.drawBG=function(){return this.bg=this.r.rect(this.px!=null&&this.px||this.x,this.py!=null&&this.py-this.ph||this.y-this.h,this.pw!=null&&this.pw||this.w,this.ph!=null&&this.ph||this.h).attr({fill:this.opts.bgcolor,"stroke-width":0,"stroke-opacity":0}).toBack()};d.prototype.logoPos=
function(){return[this.px!=null&&this.pw!=null?this.px+this.pw-150-5:this.w+this.x-150-this.padding.right,this.py!=null&&this.ph!=null?this.py-this.ph+5:this.y-this.h+this.padding.top,150,28]};d.prototype.drawLogo=function(){var a,b,c,f,e,g,j;if(!this.opts.simple){a=this.logoPos();e=a[0];g=a[1];f=a[2];a=a[3];b=[328.3,53.06];c=[f/344,a/65];e+=b[0]*c[0];g+=b[1]*c[1];return this.logo=this.r.path("M"+e+","+g+"h1.9v1.6c0.5-0.5,0.9-0.9,1.3-1.2,0.6-0.4,1.4-0.7,2.2-0.7,0.9,0,1.6,0.3,2.2,0.7,0.3,0.3,0.6,0.7,0.9,1.2,0.4-0.7,0.9-1.1,1.5-1.4,0.6-0.3,1.2-0.5,2-0.5,1.5,0,2.6,0.6,3.1,1.7,0.3,0.6,0.5,1.4,0.5,2.5v7.7h-2v-8.1c0-0.7-0.2-1.3-0.6-1.6-0.4-0.2-0.9-0.4-1.4-0.4-0.8,0-1.4,0.3-2,0.8-0.5,0.5-0.8,1.3-0.8,2.5v6.8h-2v-7.6c0-0.8-0.1-1.3-0.3-1.7-0.3-0.5-0.8-0.8-1.6-0.8-0.8,0-1.4,0.3-2,0.8-0.6,0.6-0.9,1.6-0.9,3.1v6.2h-2v-11.6zm-3.9,1.1c1,1,1.5,2.5,1.5,4.4,0,1.9-0.4,3.4-1.3,4.7-0.9,1.2-2.3,1.8-4.2,1.8-1.6,0-2.9-0.6-3.8-1.6-0.9-1.1-1.4-2.6-1.4-4.4,0-1.9,0.5-3.5,1.5-4.6,1-1.2,2.3-1.7,3.9-1.7,1.5,0,2.8,0.5,3.8,1.4zm-1.2,7.7c0.5-0.9,0.7-2,0.7-3.2,0-1.1-0.2-2-0.5-2.6-0.6-1.1-1.5-1.6-2.8-1.6-1.2,0-2,0.4-2.6,1.3-0.5,0.9-0.8,2-0.8,3.3,0,1.2,0.3,2.2,0.8,3.1,0.6,0.8,1.4,1.2,2.6,1.2,1.2,0,2.1-0.5,2.6-1.5zm-10.6-8.2c0.8,0.6,1.3,1.7,1.5,3.3h-1.9c-0.1-0.7-0.4-1.3-0.8-1.8-0.4-0.5-1.1-0.7-2-0.7-1.2,0-2.1,0.6-2.6,1.8-0.4,0.8-0.6,1.8-0.6,2.9,0,1.2,0.3,2.1,0.8,2.9,0.5,0.8,1.2,1.2,2.3,1.2,0.8,0,1.4-0.2,1.9-0.7,0.5-0.5,0.8-1.2,1-2h1.9c-0.2,1.5-0.8,2.6-1.7,3.3-0.8,0.7-1.9,1.1-3.3,1.1-1.5,0-2.7-0.6-3.6-1.7-0.9-1.1-1.3-2.4-1.3-4.1,0-2,0.5-3.6,1.4-4.7,1-1.2,2.3-1.7,3.8-1.7,1.3,0,2.4,0.3,3.2,0.9zm-13.3,8.6h2.2v2.4h-2.2v-2.4zm-181-15.8-6,12.9h-7.6c-0.9-0.4-4.5-6-5.3-7.2-3.3-4.5-6.8-8.9-10.1-13.5-1.2-1.7-2.8-3.2-4-5.1h-8.9v-2.8h17.7c3.4,0,7.2,0.3,9.6-0.8,2.2-0.9,3.9-2.5,5.2-4.3,1.1-1.7,2.8-4.6,2.1-8-1.2-4.9-4-7.791-8.5-9.251-2.6-0.81-9.8-0.61-9.8-0.61h-21v56.361h4.7v-26h6.5c6.4,8.6,12.9,17.3,19.3,26h12.9l6.5-13.1h34.5l6.4,13.1h5.4l-8.6-17.7h-41zm-41.9-34.10h17.7c4.5,0,7.8-0.1,10,2.1,1.1,1.1,2.8,3.2,2.1,5.9-0.5,2.2-1.9,4-3.9,4.8-2,0.9-5.8,0.7-8.4,0.7h-17.5v-13.50zm61.1-4.751-17.4,36.051h37.5l-17.4-36.051h-2.7zm-9.9,31.251,11-22.9,11.4,22.9h-22.4zm-127.60-26.500h25.800v51.8h4.7v-56.361h-30.500v4.561zm276.70-12.341-35.6,29.741v-29.741h-4.8v39.441l48-39.441h-7.6zm19.4,0h-7.4l-32.3,26.941,32.3,37.2h6.2l-31.6-36.400,32.8-27.741zm-163.3,0-25.1,50.841-5.9-7.8-3.4-4.5v-0.4c9.7,0,16-4.9,18.8-11.6,4.8-11.3-2.7-21.961-10.4-25.211-3.4-1.44-8-1.33-12.9-1.33h-20.3h-73.600v4.74h64.100v2.97l-30.7,0.1v56.331h4.7v-51.8h26v51.8h4.7v-59.401h22.8c4,0,8.8-0.46,12,0.57,3.4,1.12,5.9,3.35,7.7,6.031,1.7,2.6,3.5,7.2,2.1,11.6-0.7,2.3-1.9,4.2-3.2,5.9-1.3,1.7-4.4,3.4-6.6,4.2-1,0.3-3.1,0.5-3.1,0.5h-11.5c5.6,7.7,11.3,15.3,17,23h4.4c0.6-0.4,25-50.151,25.4-51.801h6.1l29.2,59.401h5.1l-31.3-64.141h-12.1zm103.5,43.641v20.5h4.8v-18.2l12.5-10.5,25,28.7h6.3l-30.6-35.1-18,14.6zm-7.7-28.3c-6.1-9.141-17.1-15.251-29.6-15.251-19.2,0-34.8,14.351-34.8,32.151,0,17.7,15.6,32.1,34.8,32.1,10.5,0,22.4-4.1,29.7-10.8v10.6h4.8v-19c-1.7,0.8-3.3,1.8-4.9,2.8v0.1c-10.9,7.1-19.4,11.2-29.9,11.3-16.4,0-29.6-12.2-29.6-27.2,0-15.1,13.2-27.311,29.6-27.311,11.5,0,21.5,6.011,26.4,14.811,0,0,2.2-1.4,3.5-2.2v20.8c-1.3,0.9-4.5,3.3-4.6,3.4-8.2,5.4-17.9,10.3-25.5,10.4-12,0-21.7-9-21.7-19.9,0-11,9.7-19.9,21.7-19.9,8.4,0,15.7,4.4,19.3,10.8l0.1,0.1c0.2,0.2,0.5,0.2,0.7,0.1,0,0,0.1-0.1,0.1-0.1,0.1-0.1,0.9-0.6,1.7-1,0.4-0.3,0.8-0.5,1.1-0.7,0.1,0,0.2-0.1,0.3-0.2h0.1l0.1-0.1c0.2-0.1,0.3-0.5,0.1-0.7-4.5-7.8-13.3-12.971-23.4-12.971-14.8,0-26.7,11.071-26.7,24.771,0,13.7,11.9,24.7,26.7,24.7,9.6,0,25.4-8.1,29.9-12.2,1.6-1.1,3.1-2.4,4.9-3.2v-41.561h-4.9v15.361z").hide().attr({fill:(j=
this.opts.logoColor)!=null?j:"#AA5128","stroke-width":0,"stroke-opacity":0,opacity:0.25,cx:e+f/2,cy:g-a/2}).scale(c[0],c[1],e,g).show()}};d.prototype.drawFootnote=function(a){var b;a!=null||(a=(b=this.opts.footnote)!=null?b:"");if(!a.match(/^\s*$/)){this.footnote=this.r.sai.prim.wrappedText(this.x+this.padding.left,this.y-this.padding.bottom,this.w,a," ");a=this.footnote.getBBox().height;this.padding.bottom+=a+10;return this.footnote.translate(0,-a)}};d.prototype.render=function(){this.opts.simple&&
this.renderPlots!=null?this.renderPlots():this.renderFull();return this};d.prototype.renderFull=function(){this.plot!=null||(this.plot=new Sai.Plot(this.r));this.plot.render();return this};d.prototype.showError=function(a){var b,c;return this.r.text(this.x+this.padding.left+((b=this.pw)!=null?b:this.w)/2,this.y-this.padding.bottom-((c=this.ph)!=null?c:this.h)/2,a)};d.prototype.setColors=function(a){var b,c;this.colors!=null||(this.colors={});for(b in a){c=this.renames[b];if(c in this.data)this.colors[c]=
a[b]}return this};d.prototype.setColor=function(a,b){this.colors!=null||(this.colors={});this.colors[this.renames[a]]=b;return this};d.prototype.normalizedHeight=function(a,b){var c,f;if(((c=this.ndata[b])!=null?c.__YVALS__:void 0)!=null){f=this.ndata[b].__YVALS__[0];c=this.ndata[b].__YVALS__[this.ndata[b].__YVALS__.length-1];if(a<f)a=f;else if(a>c)a=c;return(a-f)/(c-f)}};d.prototype.drawGuideline=function(a,b){var c;if(b==null)b="all";if(((c=this.ndata[b])!=null?c.__YVALS__:void 0)!=null){c=this.normalizedHeight(a,
b);this.guidelines!=null||(this.guidelines=this.r.set());c=new Sai.LinePlot(this.r,this.px,this.py,this.pw,this.ph,{guideline:[[0,c],[1,c]]});c.render({guideline:"#ccc"});return this.guidelines.push(c.set)}};d.prototype.drawLegend=function(a){var b,c,f,e,g;a!=null||(a=this.colors);if(a){c={};f={};for(b in a)if(b!==this.__LABELS__){c[b]=a[b];f[b]="black";if(((e=this.opts.groups)!=null?e.right:void 0)!=null)if(__indexOf.call(this.opts.groups.right,b)>=0)f[b]=this.ndata.left!=null?(g=this.colors.__RIGHTAXIS__)!=
null?g:"blue":"black"}this.legend=this.r.sai.prim.legend(this.x,this.y-this.padding.bottom,this.w,c,f);a=this.legend.getBBox();if(this.legend.length>0)this.padding.bottom+=a.height+15;return this.legend.translate((this.w-a.width)/2,0)}};d.prototype.drawTitle=function(){if(this.opts.title!=null){this.title=this.r.text(this.x+this.w/2,this.y-this.h,this.opts.title).attr({"font-size":20});this.title.translate(0,this.title.getBBox().height/2);return this.padding.top+=this.title.getBBox().height+5}};d.prototype.setupInfoSpace=
function(){this.info_y=this.y-this.h+this.padding.top;this.info_x=this.x+this.padding.left;this.info_w=this.w-this.padding.left-this.padding.right;return this.padding.top+=30};d.prototype.drawInfo=function(a,b){var c,f;if(b==null)b=true;a!=null||(a=this.default_info!=null?this.default_info():{});if(b)this.info_data={};this.info&&this.info.remove();for(c in a)c.match("^__")||(this.info_data[c]=(f=a[c])!=null?f:"(no data)");return this.info=this.r.sai.prim.info(this.info_x,this.info_y,this.info_w,this.info_data)};
d.prototype.getIndex=function(a){a=Sai.util.transformCoords(a,this.r.canvas).x;return Math.round((this.data[this.__LABELS__].length-1)*(a-this.px)/this.pw)};d.prototype.drawHistogramLegend=function(a,b){var c,f,e,g,j,h,i,k,l,n,o,m;b!=null||(b=this.colors);this.histogramLegend=this.r.set();g=Math.max(0.1*(this.h-this.padding.bottom-this.padding.top),50);k=Math.min(150,(this.w-this.padding.left-this.padding.right-20)/a.length);j=0;for(l=a.length;0<=l?j<l:j>l;0<=l?j+=1:j-=1){i=a[j];c=[];f=0;for(e=this.ndata[i][i].length;0<=
e?f<e:f>e;0<=e?f+=1:f-=1)this.ndata[i][i][f]!=null&&c.push(this.ndata[i][i][f][1]);f=c;if(((n=this.bounds)!=null?n[i]:void 0)!=null){c=this.bounds[i];e=c[0];c=c[1]}else{o=this.data[i];m=[];c=0;for(h=o.length;c<h;c++){e=o[c];e!=null&&m.push(e)}e=m;c=[Math.min.apply(Math,e),Math.max.apply(Math,e)];e=c[0];c=c[1]}c=this.getYAxisVals(e,c,true);e=c[0];h=c[c.length-1];c=b[i];this.histogramLegend.push(f=this.r.sai.prim.histogram(this.x+j*k,this.y-this.padding.bottom,k*0.8,g,f,e,h,i,typeof c==="object"?[c.__LOW__,
c.__HIGH__]:[c],"white",this.opts.fromWhite));this.opts.interactive&&this.setupHistogramInteraction(f,i)}this.histogramLegend.translate((this.w-this.padding.left-this.padding.right-this.histogramLegend.getBBox().width)/2,0);return this.padding.bottom+=g+5};d.prototype.setupHistogramInteraction=function(){return null};return d}();__hasProp=Object.prototype.hasOwnProperty;__extends=function(d,a){function b(){this.constructor=d}for(var c in a)if(__hasProp.call(a,c))d[c]=a[c];b.prototype=a.prototype;d.prototype=new b;d.__super__=a.prototype;return d};__bind=function(d,a){return function(){return d.apply(a,arguments)}};
Sai.StockChart=function(){function d(){d.__super__.constructor.apply(this,arguments)}__extends(d,Sai.Chart);d.prototype.semanticRenamePatterns={open:/^open$/i,close:/^close$/i,high:/^high$/i,low:/^low$/i,volume:/^vol(ume)?$/i};d.prototype.groupsToNullPad=function(){return["prices","volume","__META__"]};d.prototype.dataGroups=function(a){var b,c,f,e;b={__META__:[this.__LABELS__]};f=(e=this.semanticRenames.volume)!=null?e:"volume";if(f in this.data)b.volume=[f];for(c in a)if(this.caresAbout(c)&&c!==
this.__LABELS__&&c!==f){b.prices!=null||(b.prices=[]);b.prices.push(c)}return b};d.prototype.nonNegativeGroups=function(){return["volume"]};d.prototype.renderPlots=function(){var a,b,c,f,e,g,j,h,i,k,l,n;this.px==null&&this.setPlotCoords();e=(b=this.semanticRenames.open)!=null?b:"open";b=(c=this.semanticRenames.close)!=null?c:"close";c=(f=this.semanticRenames.high)!=null?f:"high";f=(i=this.semanticRenames.low)!=null?i:"low";i=(n=this.semanticRenames.volume)!=null?n:"volume";this.colors!=null||(this.colors=
{});(g=this.colors).up!=null||(g.up="black");(h=this.colors).down!=null||(h.down="red");(k=this.colors).vol_up!=null||(k.vol_up="#666666");(l=this.colors).vol_down!=null||(l.vol_down="#cc6666");this.drawLogo();this.drawBG();if(this.ndata.prices!=null&&e in this.ndata.prices&&b in this.ndata.prices&&c in this.ndata.prices&&f in this.ndata.prices){this.ndata.prices.__YVALS__[0]<0&&this.drawGuideline(0,"prices");this.plots=this.r.set();h={up:[],down:[]};g={};for(a in this.ndata.prices)a.match("^__")||
a===this.__LABELS__||(g[a]=this.data[a]);if(this.data[i]!=null)g.vol=this.data[i];if("volume"in this.ndata){a=0;for(k=this.ndata.volume[i].length;0<=k?a<k:a>k;0<=k?a+=1:a-=1)if(this.ndata.volume[i][a]!==null)if(a&&this.ndata.prices[b][a-1]&&this.ndata.prices[b][a][1]<this.ndata.prices[b][a-1][1]){h.down.push(this.ndata.volume[i][a]);h.up.push([this.ndata.volume[i][a][0],0])}else{h.up.push(this.ndata.volume[i][a]);h.down.push([this.ndata.volume[i][a][0],0])}else{h.up.push([0,0]);h.down.push([0,0])}this.plots.push((new Sai.BarPlot(this.r,
this.px,this.py,this.pw,this.ph*0.2,h,g)).render(true,this.normalizedHeight(0,"volume"),{up:this.colors.vol_up,down:this.colors.vol_down}).set)}this.plots.push((new Sai.CandlestickPlot(this.r,this.px,this.py,this.pw,this.ph,{open:this.ndata.prices[e],close:this.ndata.prices[b],high:this.ndata.prices[c],low:this.ndata.prices[f]},g)).render(this.colors,Math.min(5,this.pw/this.ndata.prices[e].length-2)).set);a={};for(j in this.ndata.prices)j===e||j===b||j===c||j===f||j.match("^__")||j===this.__LABELS__||
(a[j]=this.ndata.prices[j]);return this.plots.push((new Sai.LinePlot(this.r,this.px,this.py,this.pw,this.ph,a)).render(this.colors).set)}else this.showError("This chart requires data series named\nopen, close, high, and low.\n \nOnce you add series with these names, the chart will display.")};d.prototype.renderFull=function(){var a,b,c,f,e,g,j,h,i,k;this.drawTitle();this.setupInfoSpace();this.drawFootnote();g=(b=this.semanticRenames.open)!=null?b:"open";b=(f=this.semanticRenames.close)!=null?f:"close";
f=(e=this.semanticRenames.high)!=null?e:"high";e=(a=this.semanticRenames.low)!=null?a:"low";i=(h=this.semanticRenames.volume)!=null?h:"volume";a={};h=false;for(j in this.ndata.prices)if(j!==g&&j!==b&&j!==f&&j!==e&&!(j.match("^__")||j===this.__LABELS__)){a[j]=((k=this.colors)!=null?k[j]:void 0)||"black";h=true}h&&this.drawLegend(a);this.addAxes(["prices"]);this.renderPlots();c=this.pw/(this.data[this.__LABELS__].length-1);this.glow=this.r.rect(this.px-c/2,this.py-this.ph,c,this.ph).attr({fill:"0-"+
this.opts.bgcolor+"-#DDAA99-"+this.opts.bgcolor,"stroke-width":0,"stroke-opacity":0}).toBack().hide();this.bg.toBack();this.r.set().push(this.bg,this.plots,this.logo,this.glow,this.guidelines).mousemove(__bind(function(l){var n,o,m,p,q;l=this.getIndex(l);n={};if(this.data[this.__LABELS__][l]!=null)n[this.__LABELS__]=this.data[this.__LABELS__][l];o=false;for(m in this.ndata.prices)if(!(m.match("^__")||m===this.__LABELS__))if(((p=this.data[m])!=null?p[l]:void 0)!=null){n[m]=this.data[m][l];o=true}if(((q=
this.data[i])!=null?q[l]:void 0)!=null){n[i]=this.data[i][l];o=true}this.drawInfo(n);if(o)return this.glow.attr({x:this.px+c*(l-0.5)}).show()},this)).mouseout(__bind(function(){this.drawInfo({},true);return this.glow.hide()},this));return this};return d}();__hasProp=Object.prototype.hasOwnProperty;__extends=function(d,a){function b(){this.constructor=d}for(var c in a)if(__hasProp.call(a,c))d[c]=a[c];b.prototype=a.prototype;d.prototype=new b;d.__super__=a.prototype;return d};
Sai.ScatterChart=function(){function d(){d.__super__.constructor.apply(this,arguments)}__extends(d,Sai.Chart);d.prototype.dataGroups=function(a){var b,c;b=[];for(c in a)if(c.match("^__")||c===this.__LABELS__)b.push(c);b={__META__:b};for(c in a)c.match("^__")||c===this.__LABELS__||(b[c]=[c]);return b};d.prototype.renderPlots=function(){var a,b,c,f,e,g,j;this.px==null&&this.setPlotCoords();a=(g=(j=this.opts.colors)!=null?j:this.colors)!=null?g:["black","white"];g=(e=this.opts.stroke_opacity)!=null?
e:[0,1];e=(c=this.opts.stroke_colors)!=null?c:["black","black"];c=(b=this.opts.radius)!=null?b:[4,12];this.drawLogo();this.drawBG();b={};for(f in this.ndata)b[f]=this.ndata[f][f];this.plots=this.r.set();this.plots.push((new Sai.ScatterPlot(this.r,this.px,this.py,this.pw,this.ph,b,this.data)).render(this.opts.mappings,a,c,g,e,this.opts.interactive&&!this.opts.simple,this.drawInfo).set);return this};d.prototype.renderFull=function(){var a,b,c,f,e,g;this.drawTitle();this.setupInfoSpace();this.drawFootnote();
b=(g=(e=this.opts.colors)!=null?e:this.colors)!=null?g:["black","white"];g=(f=this.opts.stroke_colors)!=null?f:["black","black"];e=[];f={};if(b instanceof Array){e.push(this.opts.mappings.color);f[this.opts.mappings.color]={__LOW__:b[0],__HIGH__:b[1]}}else{typeof legend_colors!="undefined"&&legend_colors!==null||(legend_colors={});c=true;for(a in b)legend_colors[a]=b[a]}if(!(g instanceof Array)){typeof legend_colors!="undefined"&&legend_colors!==null||(legend_colors={});c=true;for(a in b)legend_colors[a]=
g[a]}e.length&&this.drawHistogramLegend(e,f);c&&this.drawLegend(b);this.__LABELS__="__XVALS__";this.data.__XVALS__=this.ndata[this.opts.mappings.x].__YVALS__;this.addAxes([this.opts.mappings.y],{left:this.opts.mappings.y,bottom:this.opts.mappings.x});this.renderPlots();a=this.r.set().push(this.plots,this.bg,this.logo,this.info,this.footnote,this.histogramLegend,this.legend);this.opts.href&&a.attr({href:this.opts.href,target:"_blank"});return this};return d}();__hasProp=Object.prototype.hasOwnProperty;__extends=function(d,a){function b(){this.constructor=d}for(var c in a)if(__hasProp.call(a,c))d[c]=a[c];b.prototype=a.prototype;d.prototype=new b;d.__super__=a.prototype;return d};__bind=function(d,a){return function(){return d.apply(a,arguments)}};
Sai.LineChart=function(){function d(){d.__super__.constructor.apply(this,arguments)}__extends(d,Sai.Chart);d.prototype.nonNegativeGroups=function(){return this.opts.stacked?["all","left","right"]:[]};d.prototype.dataGroups=function(){var a,b,c,f,e,g;a=d.__super__.dataGroups.apply(this,arguments);if(((b=this.opts.groups)!=null?b.left:void 0)!=null&&((c=this.opts.groups)!=null?c.right:void 0)!=null){e=this.opts.groups.left;g=[];c=0;for(f=e.length;c<f;c++){b=e[c];this.caresAbout(b)&&b in this.data&&
g.push(b)}a.left=g;e=this.opts.groups.right;g=[];c=0;for(f=e.length;c<f;c++){b=e[c];this.caresAbout(b)&&b in this.data&&g.push(b)}a.right=g}return a};d.prototype.renderPlots=function(){var a,b,c,f,e,g,j,h;this.px==null&&this.setPlotCoords();this.drawBG();this.drawLogo();c="right"in this.ndata;a=this.opts.stacked!=null?this.stackedNdata:this.ndata;b=this.opts.area?Sai.AreaPlot:Sai.LinePlot;if(c){if(((f=this.ndata.left)!=null?f.__YVALS__[0]:void 0)<0)this.drawGuideline(0,"left");if(((e=this.ndata.right)!=
null?e.__YVALS__[0]:void 0)<0)this.drawGuideline(0,"right")}else this.ndata.all.__YVALS__[0]<0&&this.drawGuideline(0,"all");this.plots=[];if(c){if(a.left!=null)this.plots.push((new b(this.r,this.px,this.py,this.pw,this.ph,a.left)).render(this.colors,(g=this.opts.lineWidth)!=null?g:2,this.opts.stacked,this.getBaseline("left")));if(a.right!=null)return this.plots.push((new b(this.r,this.px,this.py,this.pw,this.ph,a.right)).render(this.colors,(j=this.opts.lineWidth)!=null?j:2,this.opts.stacked,this.getBaseline("right")))}else return this.plots.push((new b(this.r,
this.px,this.py,this.pw,this.ph,a.all)).render(this.colors,(h=this.opts.lineWidth)!=null?h:2,this.opts.stacked,this.getBaseline("all")))};d.prototype.renderFull=function(){var a,b,c,f,e,g,j;this.drawTitle();this.setupInfoSpace();this.drawFootnote();this.drawLegend();"right"in this.ndata?this.addAxes(["left","right"]):this.addAxes(["all"]);this.renderPlots();this.plotSets=this.r.set();e=this.plots;c=0;for(f=e.length;c<f;c++){a=e[c];this.plotSets.push(a.set)}this.dots=this.r.set();for(b in this.ndata.all)if(b!==
"__YVALS__")this.dots.push(this.r.circle(0,0,4).attr({fill:(g=(j=this.colors)!=null?j[b]:void 0)!=null?g:"black"}).hide());a=this.r.set().push(this.bg,this.plotSets,this.dots,this.logo,this.guidelines).mousemove(__bind(function(h){var i,k,l,n,o,m,p,q,r,s;k=this.getIndex(h);h={};if(((q=this.data[this.__LABELS__])!=null?q.length:void 0)>k&&k>=0){h[this.__LABELS__]=this.data[this.__LABELS__][k];for(o in this.ndata.all)if(this.data[o]!=null)h[o]=this.data[o][k]}this.drawInfo(h);i=0;q=[];for(o in this.ndata.all)o!==
"__YVALS__"&&q.push(function(){r=this.plots;s=[];m=0;for(p=r.length;m<p;m++){l=r[m];if(o in l.dndata){n=l.dndata[o][k];n!=null?this.dots[i].attr({cx:n[0],cy:n[1]}).show().toFront():this.dots[i].hide();s.push(i++)}}return s}.call(this));return q},this)).mouseout(__bind(function(){this.drawInfo({},true);return this.dots.hide()},this));this.opts.href&&a.attr({href:this.opts.href,target:"_blank"});return this};return d}();__bind=function(d,a){return function(){return d.apply(a,arguments)}};__hasProp=Object.prototype.hasOwnProperty;__extends=function(d,a){function b(){this.constructor=d}for(var c in a)if(__hasProp.call(a,c))d[c]=a[c];b.prototype=a.prototype;d.prototype=new b;d.__super__=a.prototype;return d};
Sai.GeoChart=function(){function d(){this.renderPlots=__bind(this.renderPlots,this);d.__super__.constructor.apply(this,arguments)}__extends(d,Sai.Chart);d.prototype.plotType=Sai.GeoPlot;d.prototype.interactiveHistogram=true;d.prototype.getMax=function(a){return Math.max.apply(Math,a)};d.prototype.getMin=function(a){return Math.min.apply(Math,a)};d.prototype.normalize=function(a){var b,c,f,e,g,j,h,i,k,l,n,o,m,p,q;this.ndata={};this.bounds={};e={};j={};for(k in a)if(!(k.match("^__")||k===this.__LABELS__))if(a[k]!=
null){o=a[k];p=[];l=0;for(n=o.length;l<n;l++){b=o[l];b!=null&&p.push(b)}b=p;e[k]=this.getMax(b,k);if(!(typeof h!="undefined"&&h!==null)||e[k]>h)h=e[k];j[k]=this.getMin(b,k);if(!(typeof i!="undefined"&&i!==null)||j[k]<i)i=j[k]}b=[];for(k in a)if(!(k.match("^__")||k===this.__LABELS__))if(a[k]!=null){if(this.opts.groupedNormalization){f=h;g=i}else{f=e[k];g=j[k]}this.bounds[k]=[g,f];this.ndata[k]={};b.push(this.ndata[k][k]=function(){q=[];c=0;for(m=a[k].length;0<=m?c<m:c>m;0<=m?c+=1:c-=1)q.push(a[k][c]!=
null?[c/(a[k].length-1),(a[k][c]-g)/(f-g)]:null);return q}())}return b};d.prototype.dataGroups=function(a){var b,c;b=[];for(c in a)if(c.match("^__")||c===this.__LABELS__)b.push(c);b={__META__:b};for(c in a)c.match("^__")||c===this.__LABELS__||(b[c]=[c]);return b};d.prototype.setupHistogramInteraction=function(a,b){return a.click(__bind(function(){return this.renderPlots(b)},this)).hover(__bind(function(c){return __bind(function(){c.attr({"fill-opacity":0.75});return this.drawInfo({"Click to display on map":b})},
this)},this)(a),__bind(function(c){return __bind(function(){c.attr({"fill-opacity":1});return this.drawInfo()},this)},this)(a))};d.prototype.renderPlots=function(a){var b,c;this.px==null&&this.setPlotCoords();if((b=this.bg)!=null)b.remove();if((b=this.logo)!=null)b.remove();if((b=this.geoPlot)!=null)b.set.remove();this.drawBG();this.drawLogo();b={};for(c in this.ndata)b[c]=this.ndata[c][c];this.geoPlot=(new this.plotType(this.r,this.px,this.py,this.pw,this.ph,b,this.data,{fromWhite:this.opts.fromWhite})).render(this.colors||
{},this.data.__MAP__,this.__LABELS__,a!=null?a:this.data.__DEFAULT__,this.opts.bgcolor,this.opts.interactive&&!this.opts.simple,this.drawInfo);return this};d.prototype.default_info=function(){return{"":this.opts.interactive?"Click histogram below to change map display":""}};d.prototype.renderFull=function(){var a,b,c;this.drawTitle();this.setupInfoSpace();this.drawFootnote();this.drawHistogramLegend(function(){c=[];for(b in this.data)b.match("^__")||b===this.__LABELS__||c.push(b);return c}.call(this));
this.setPlotCoords();this.drawInfo();this.renderPlots();a=this.r.set().push(this.geoPlot.set,this.bg,this.logo,this.info,this.footnote);this.opts.href&&a.attr({href:this.opts.href,target:"_blank"});return this};return d}();
Sai.ChromaticGeoChart=function(){function d(){d.__super__.constructor.apply(this,arguments)}__extends(d,Sai.GeoChart);d.prototype.plotType=Sai.ChromaticGeoPlot;d.prototype.interactiveHistogram=false;d.prototype.default_info=function(){return{}};d.prototype.setupHistogramInteraction=function(){return false};return d}();__hasProp=Object.prototype.hasOwnProperty;__extends=function(d,a){function b(){this.constructor=d}for(var c in a)if(__hasProp.call(a,c))d[c]=a[c];b.prototype=a.prototype;d.prototype=new b;d.__super__=a.prototype;return d};
Sai.BarChart=function(){function d(){d.__super__.constructor.apply(this,arguments)}__extends(d,Sai.Chart);d.prototype.getMin=function(){return Math.min(d.__super__.getMin.apply(this,arguments),0)};d.prototype.groupsToNullPad=function(){var a,b;b=[];for(a in this.dataGroups())b.push(a);return b};d.prototype.tooMuchData=function(){var a,b,c;b=this.w/3;a=0;for(c in this.data)if(c!==this.__LABELS__){a+=this.data[c].length;if(this.opts.stacked)break}return a>b};d.prototype.renderPlots=function(){var a,
b,c,f,e;this.px==null&&this.setPlotCoords();this.drawLogo();this.drawBG();if(this.tooMuchData()){this.showError("Sorry, the chart isn't wide enough to plot this much data.\n \nPossible solutions include downsampling your data\n (e.g. weekly instead of daily) or using a line chart");return this}if("all"in this.ndata){this.guidelines=this.r.set();e=this.ndata.all.__YVALS__.slice(1,this.ndata.all.__YVALS__.length-1);b=0;for(c=e.length;b<c;b++){a=e[b];this.drawGuideline(a)}}this.plots=this.r.set();a=
{};c={};c[this.__LABELS__]=this.data[this.__LABELS__];b=this.opts.stacked!=null?this.stackedNdata:this.ndata;for(f in b.all)if(!(f.match("^__")||f===this.__LABELS__)){a[f]=b.all[f];c[f]=this.data[f]}return this.plots.push((new Sai.BarPlot(this.r,this.px,this.py,this.pw,this.ph,a,c)).render(this.opts.stacked!=null,this.normalizedHeight(0,"all"),this.colors,this.opts.interactive&&!this.opts.simple,this.drawInfo,this.__LABELS__).set)};d.prototype.renderFull=function(){var a;this.drawTitle();this.setupInfoSpace();
this.drawFootnote();this.drawLegend();this.addAxes(["all"]);this.renderPlots();a=this.r.set().push(this.plots,this.bg,this.logo,this.guidelines);this.opts.href&&a.attr({href:this.opts.href,target:"_blank"});return this};return d}();__hasProp=Object.prototype.hasOwnProperty;__extends=function(d,a){function b(){this.constructor=d}for(var c in a)if(__hasProp.call(a,c))d[c]=a[c];b.prototype=a.prototype;d.prototype=new b;d.__super__=a.prototype;return d};
Sai.StreamChart=function(){function d(a,b,c,f,e,g,j,h){this.r=a;this.x=b;this.y=c;this.w=f;this.h=e;this.__LABELS__=j;this.opts=h;this.opts.stacked=true;d.__super__.constructor.apply(this,arguments)}__extends(d,Sai.LineChart);d.prototype.getStackedMax=function(){return d.__super__.getStackedMax.apply(this,arguments)/2};d.prototype.getStackedMin=function(a,b){var c,f;c=d.__super__.getStackedMin.apply(this,arguments);f=this.getStackedMax(a,b);return c-f};d.prototype.normalize=function(a){var b,c,f,
e,g,j,h,i,k,l,n,o,m,p,q,r;d.__super__.normalize.apply(this,arguments);c=this.dataGroups(this.data);this.baselines!=null||(this.baselines={});p=[];for(b in this.stackedNdata){e=this.normalizedHeight(0,b!=null?b:"all");this.normalizedHeight(this.getStackedMin(a,c[b]),b);this.baselines[b]=[];var s=this.ndata[b];o=this.ndata[b].__YVALS__;q=[];l=0;for(n=o.length;l<n;l++){k=o[l];q.push(Math.abs(k))}s.__YVALS__=q;for(h in this.stackedNdata[b])i=h;p.push(function(){r=[];f=0;for(m=this.stackedNdata[b][h].length;0<=
m?f<m:f>m;0<=m?f+=1:f-=1){g=(this.stackedNdata[b][i][f][1]-e)/2;for(h in this.stackedNdata[b]){j=this.stackedNdata[b][h][f];if(j!=null)j[1]-=g}r.push(this.baselines[b].push([j[0],e-g]))}return r}.call(this))}return p};d.prototype.addAxes=function(a,b){if(b==null)b={};"left"in b||(b.left="magnitude");return d.__super__.addAxes.call(this,a,b)};d.prototype.getBaseline=function(a){return this.baselines[a]};return d}();
